{"ast":null,"code":"import express from 'express';\nimport { generateSitemap } from '@plone/volto/helpers';\nexport const sitemap = function (req, res, next) {\n  generateSitemap(req).then(sitemap => {\n    if (Buffer.isBuffer(sitemap)) {\n      res.set('Content-Type', 'application/x-gzip');\n      res.set('Content-Encoding', 'gzip');\n      res.set('Content-Disposition', 'attachment; filename=\"sitemap.xml.gz\"');\n      res.send(sitemap);\n    } else {\n      var _sitemap$code;\n\n      // {\"errno\":-111, \"code\":\"ECONNREFUSED\", \"host\": ...}\n      res.status(500); // Some data, such as the internal API address, may be sensitive to be published\n\n      res.send(`Sitemap generation error: ${(_sitemap$code = sitemap.code) !== null && _sitemap$code !== void 0 ? _sitemap$code : '-'}`);\n    }\n  });\n};\nexport default function () {\n  const middleware = express.Router();\n  middleware.all('**/sitemap.xml.gz', sitemap);\n  middleware.id = 'sitemap.xml.gz';\n  return middleware;\n}","map":{"version":3,"names":["express","generateSitemap","sitemap","req","res","next","then","Buffer","isBuffer","set","send","status","code","middleware","Router","all","id"],"sources":["/home/jakob/workspace/training-project/node_modules/@plone/volto/src/express-middleware/sitemap.js"],"sourcesContent":["import express from 'express';\nimport { generateSitemap } from '@plone/volto/helpers';\n\nexport const sitemap = function (req, res, next) {\n  generateSitemap(req).then((sitemap) => {\n    if (Buffer.isBuffer(sitemap)) {\n      res.set('Content-Type', 'application/x-gzip');\n      res.set('Content-Encoding', 'gzip');\n      res.set('Content-Disposition', 'attachment; filename=\"sitemap.xml.gz\"');\n      res.send(sitemap);\n    } else {\n      // {\"errno\":-111, \"code\":\"ECONNREFUSED\", \"host\": ...}\n      res.status(500);\n      // Some data, such as the internal API address, may be sensitive to be published\n      res.send(`Sitemap generation error: ${sitemap.code ?? '-'}`);\n    }\n  });\n};\n\nexport default function () {\n  const middleware = express.Router();\n\n  middleware.all('**/sitemap.xml.gz', sitemap);\n  middleware.id = 'sitemap.xml.gz';\n  return middleware;\n}\n"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,SAApB;AACA,SAASC,eAAT,QAAgC,sBAAhC;AAEA,OAAO,MAAMC,OAAO,GAAG,UAAUC,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;EAC/CJ,eAAe,CAACE,GAAD,CAAf,CAAqBG,IAArB,CAA2BJ,OAAD,IAAa;IACrC,IAAIK,MAAM,CAACC,QAAP,CAAgBN,OAAhB,CAAJ,EAA8B;MAC5BE,GAAG,CAACK,GAAJ,CAAQ,cAAR,EAAwB,oBAAxB;MACAL,GAAG,CAACK,GAAJ,CAAQ,kBAAR,EAA4B,MAA5B;MACAL,GAAG,CAACK,GAAJ,CAAQ,qBAAR,EAA+B,uCAA/B;MACAL,GAAG,CAACM,IAAJ,CAASR,OAAT;IACD,CALD,MAKO;MAAA;;MACL;MACAE,GAAG,CAACO,MAAJ,CAAW,GAAX,EAFK,CAGL;;MACAP,GAAG,CAACM,IAAJ,CAAU,6BAAD,iBAA6BR,OAAO,CAACU,IAArC,yDAA6C,GAAI,EAA1D;IACD;EACF,CAZD;AAaD,CAdM;AAgBP,eAAe,YAAY;EACzB,MAAMC,UAAU,GAAGb,OAAO,CAACc,MAAR,EAAnB;EAEAD,UAAU,CAACE,GAAX,CAAe,mBAAf,EAAoCb,OAApC;EACAW,UAAU,CAACG,EAAX,GAAgB,gBAAhB;EACA,OAAOH,UAAP;AACD"},"metadata":{"react-intl":{"messages":[]}},"sourceType":"module"}