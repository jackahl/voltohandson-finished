{"ast":null,"code":"import _isObject from \"lodash/isObject\";\nimport _find from \"lodash/find\";\nvar _jsxFileName = \"/home/jakob/workspace/training-project/node_modules/@plone/volto/src/components/manage/Widgets/ArrayWidget.jsx\";\nvar __jsx = React.createElement;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n/**\n * ArrayWidget component.\n * @module components/manage/Widgets/ArrayWidget\n */\nimport React, { Component } from 'react';\nimport { defineMessages, injectIntl } from 'react-intl';\nimport PropTypes from 'prop-types';\nimport { compose } from 'redux';\nimport { connect } from 'react-redux';\nimport { injectLazyLibs } from '@plone/volto/helpers/Loadable/Loadable';\nimport { getVocabFromHint, getVocabFromField, getVocabFromItems } from '@plone/volto/helpers';\nimport { getVocabulary } from '@plone/volto/actions';\nimport { Option, DropdownIndicator, ClearIndicator, selectTheme, customSelectStyles, MenuList, SortableMultiValue, SortableMultiValueLabel } from '@plone/volto/components/manage/Widgets/SelectStyling';\nimport { FormFieldWrapper } from '@plone/volto/components';\nconst messages = defineMessages({\n  select: {\n    \"id\": \"Select\\u2026\",\n    \"defaultMessage\": \"Select\\u2026\"\n  },\n  no_value: {\n    \"id\": \"No value\",\n    \"defaultMessage\": \"No value\"\n  },\n  no_options: {\n    \"id\": \"No options\",\n    \"defaultMessage\": \"No options\"\n  }\n});\n\nfunction arrayMove(array, from, to) {\n  const slicedArray = array.slice();\n  slicedArray.splice(to < 0 ? array.length + to : to, 0, slicedArray.splice(from, 1)[0]);\n  return slicedArray;\n}\n\nfunction normalizeArrayValue(choices, value) {\n  if (!value || !Array.isArray(value)) return [];\n  if (value.length === 0) return value;\n\n  if (typeof value[0] === 'string') {\n    // raw value like ['foo', 'bar']\n    return value.map(v => {\n      var _find2;\n\n      return {\n        label: ((_find2 = _find(choices, c => c.value === v)) === null || _find2 === void 0 ? void 0 : _find2.label) || v,\n        value: v\n      };\n    });\n  }\n\n  if (_isObject(value[0]) && Object.keys(value[0]).includes('token') // Array of objects, w/ label+value\n  ) {\n    return value.map(v => {\n      const item = _find(choices, c => c.value === v.token);\n\n      return item ? {\n        label: item.label || item.title || item.token,\n        value: v.token\n      } : {\n        // avoid a crash if choices doesn't include this item\n        label: v.label,\n        value: v.token\n      };\n    }).filter(f => !!f);\n  }\n\n  return [];\n}\n\nfunction normalizeChoices(choices) {\n  if (Array.isArray(choices) && choices.length && Array.isArray(choices[0])) {\n    return choices.map(option => ({\n      value: option[0],\n      label: // Fix \"None\" on the serializer, to remove when fixed in p.restapi\n      option[1] !== 'None' && option[1] ? option[1] : option[0]\n    }));\n  }\n\n  return choices;\n}\n/**\n * Compare values and return true if equal.\n * Consider upper and lower case.\n * @method compareOption\n * @param {*} inputValue\n * @param {*} option\n * @param {*} accessors\n * @returns {boolean}\n */\n\n\nconst compareOption = (inputValue = '', option, accessors) => {\n  const candidate = String(inputValue);\n  const optionValue = String(accessors.getOptionValue(option));\n  const optionLabel = String(accessors.getOptionLabel(option));\n  return optionValue === candidate || optionLabel === candidate;\n};\n/**\n * ArrayWidget component class.\n * @class ArrayWidget\n * @extends Component\n *\n * A createable select array widget will be rendered if the named vocabulary is\n * in the widget definition (hint) like:\n *\n * ```\n * list_field_voc_unconstrained = schema.List(\n *     title=u\"List field with values from vocabulary but not constrained to them.\",\n *     description=u\"zope.schema.List\",\n *     value_type=schema.TextLine(),\n *     required=False,\n *     missing_value=[],\n * )\n * directives.widget(\n *     \"list_field_voc_unconstrained\",\n *     AjaxSelectFieldWidget,\n *     vocabulary=\"plone.app.vocabularies.PortalTypes\",\n * )\n * ```\n */\n\n\nclass ArrayWidget extends Component {\n  /**\n   * Property types.\n   * @property {Object} propTypes Property types.\n   * @static\n   */\n\n  /**\n   * Default properties\n   * @property {Object} defaultProps Default properties.\n   * @static\n   */\n\n  /**\n   * Constructor\n   * @method constructor\n   * @param {Object} props Component properties\n   * @constructs Actions\n   */\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"onSortEnd\", (selectedOption, {\n      oldIndex,\n      newIndex\n    }) => {\n      const newValue = arrayMove(selectedOption, oldIndex, newIndex);\n      this.handleChange(newValue);\n    });\n\n    this.handleChange = this.handleChange.bind(this);\n  }\n  /**\n   * Component did mount\n   * @method componentDidMount\n   * @returns {undefined}\n   */\n\n\n  componentDidMount() {\n    var _this$props$items, _this$props$items$cho, _this$props$choices;\n\n    if (!((_this$props$items = this.props.items) !== null && _this$props$items !== void 0 && (_this$props$items$cho = _this$props$items.choices) !== null && _this$props$items$cho !== void 0 && _this$props$items$cho.length) && !((_this$props$choices = this.props.choices) !== null && _this$props$choices !== void 0 && _this$props$choices.length) && this.props.vocabBaseUrl) {\n      this.props.getVocabulary({\n        vocabNameOrURL: this.props.vocabBaseUrl,\n        size: -1,\n        subrequest: this.props.lang\n      });\n    }\n  }\n\n  componentDidUpdate() {\n    var _this$props$items2, _this$props$items2$ch, _this$props$choices2;\n\n    if (!((_this$props$items2 = this.props.items) !== null && _this$props$items2 !== void 0 && (_this$props$items2$ch = _this$props$items2.choices) !== null && _this$props$items2$ch !== void 0 && _this$props$items2$ch.length) && !((_this$props$choices2 = this.props.choices) !== null && _this$props$choices2 !== void 0 && _this$props$choices2.length) && this.props.vocabLoading === undefined && !this.props.vocabLoaded) {\n      this.props.getVocabulary({\n        vocabNameOrURL: this.props.vocabBaseUrl,\n        size: -1,\n        subrequest: this.props.lang\n      });\n    }\n  }\n  /**\n   * Handle the field change, store it in the local state and back to simple\n   * array of tokens for correct serialization\n   * @method handleChange\n   * @param {array} selectedOption The selected options (already aggregated).\n   * @returns {undefined}\n   */\n\n\n  handleChange(selectedOption) {\n    this.props.onChange(this.props.id, selectedOption ? selectedOption.map(item => item.value) : null);\n  }\n\n  /**\n   * Render method.\n   * @method render\n   * @returns {string} Markup for the component.\n   */\n  render() {\n    var _this$props, _this$props2, _this$props$choices3, _this$props$placehold;\n\n    const choices = normalizeChoices(((_this$props = this.props) === null || _this$props === void 0 ? void 0 : _this$props.choices) || []);\n    const selectedOption = normalizeArrayValue(choices, this.props.value);\n    const CreatableSelect = this.props.reactSelectCreateable.default;\n    const {\n      SortableContainer\n    } = this.props.reactSortableHOC;\n    const Select = this.props.reactSelect.default;\n    const SortableSelect = // It will be only createable if the named vocabulary is in the widget definition\n    // (hint) like:\n    // list_field_voc_unconstrained = schema.List(\n    //     title=u\"List field with values from vocabulary but not constrained to them.\",\n    //     description=u\"zope.schema.List\",\n    //     value_type=schema.TextLine(),\n    //     required=False,\n    //     missing_value=[],\n    // )\n    // directives.widget(\n    //     \"list_field_voc_unconstrained\",\n    //     AjaxSelectFieldWidget,\n    //     vocabulary=\"plone.app.vocabularies.PortalTypes\",\n    // )\n    (_this$props2 = this.props) !== null && _this$props2 !== void 0 && _this$props2.choices && !getVocabFromHint(this.props) && !this.props.creatable ? SortableContainer(Select) : SortableContainer(CreatableSelect);\n    return __jsx(FormFieldWrapper, _extends({}, this.props, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 302,\n        columnNumber: 7\n      }\n    }), __jsx(SortableSelect, {\n      useDragHandle: true // react-sortable-hoc props:\n      ,\n      axis: \"xy\",\n      onSortEnd: this.onSortEnd,\n      distance: 4 // small fix for https://github.com/clauderic/react-sortable-hoc/pull/352:\n      ,\n      getHelperDimensions: ({\n        node\n      }) => node.getBoundingClientRect(),\n      id: `field-${this.props.id}`,\n      key: this.props.id,\n      isDisabled: this.props.disabled || this.props.isDisabled,\n      className: \"react-select-container\",\n      classNamePrefix: \"react-select\",\n      options: this.props.vocabBaseUrl ? choices : this.props.choices ? [...choices, ...(this.props.noValueOption && !this.props.default ? [{\n        label: this.props.intl.formatMessage(messages.no_value),\n        value: 'no-value'\n      }] : [])] : [{\n        label: this.props.intl.formatMessage(messages.no_value),\n        value: 'no-value'\n      }],\n      styles: customSelectStyles,\n      theme: selectTheme,\n      components: _objectSpread(_objectSpread({}, ((_this$props$choices3 = this.props.choices) === null || _this$props$choices3 === void 0 ? void 0 : _this$props$choices3.length) > 25 && {\n        MenuList\n      }), {}, {\n        MultiValue: SortableMultiValue,\n        MultiValueLabel: SortableMultiValueLabel,\n        DropdownIndicator,\n        ClearIndicator,\n        Option\n      }),\n      value: selectedOption || [],\n      placeholder: (_this$props$placehold = this.props.placeholder) !== null && _this$props$placehold !== void 0 ? _this$props$placehold : this.props.intl.formatMessage(messages.select),\n      onChange: this.handleChange,\n      isValidNewOption: (inputValue, selectValue, selectOptions, accessors) => !(!inputValue || selectValue.some(option => compareOption(inputValue, option, accessors)) || selectOptions.some(option => compareOption(inputValue, option, accessors))),\n      isClearable: true,\n      isMulti: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 303,\n        columnNumber: 9\n      }\n    }));\n  }\n\n}\n\n_defineProperty(ArrayWidget, \"propTypes\", {\n  id: PropTypes.string.isRequired,\n  title: PropTypes.string.isRequired,\n  description: PropTypes.string,\n  required: PropTypes.bool,\n  error: PropTypes.arrayOf(PropTypes.string),\n  getVocabulary: PropTypes.func.isRequired,\n  choices: PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.object, PropTypes.array])),\n  vocabLoading: PropTypes.bool,\n  vocabLoaded: PropTypes.bool,\n  items: PropTypes.shape({\n    vocabulary: PropTypes.object\n  }),\n  widgetOptions: PropTypes.shape({\n    vocabulary: PropTypes.object\n  }),\n  value: PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.object, PropTypes.string])),\n  placeholder: PropTypes.string,\n  onChange: PropTypes.func.isRequired,\n  wrapped: PropTypes.bool,\n  creatable: PropTypes.bool //if widget has no vocab and you want to be creatable\n\n});\n\n_defineProperty(ArrayWidget, \"defaultProps\", {\n  description: null,\n  required: false,\n  items: {\n    vocabulary: null\n  },\n  widgetOptions: {\n    vocabulary: null\n  },\n  error: [],\n  choices: [],\n  value: null,\n  creatable: false\n});\n\nexport const ArrayWidgetComponent = injectIntl(ArrayWidget);\nexport default compose(injectIntl, injectLazyLibs(['reactSelect', 'reactSelectCreateable', 'reactSortableHOC']), connect((state, props) => {\n  var _state$vocabularies, _state$vocabularies$v, _state$vocabularies$v2, _props$items;\n\n  const vocabBaseUrl = getVocabFromHint(props) || getVocabFromField(props) || getVocabFromItems(props);\n  const vocabState = (_state$vocabularies = state.vocabularies) === null || _state$vocabularies === void 0 ? void 0 : (_state$vocabularies$v = _state$vocabularies[vocabBaseUrl]) === null || _state$vocabularies$v === void 0 ? void 0 : (_state$vocabularies$v2 = _state$vocabularies$v.subrequests) === null || _state$vocabularies$v2 === void 0 ? void 0 : _state$vocabularies$v2[state.intl.locale]; // If the schema already has the choices in it, then do not try to get the vocab,\n  // even if there is one\n\n  if ((_props$items = props.items) !== null && _props$items !== void 0 && _props$items.choices) {\n    return {\n      choices: props.items.choices,\n      lang: state.intl.locale\n    };\n  } else if (vocabState) {\n    return {\n      choices: vocabState.items,\n      vocabBaseUrl,\n      vocabLoading: vocabState.loading,\n      vocabLoaded: vocabState.loaded,\n      lang: state.intl.locale\n    };\n  }\n\n  return {\n    vocabBaseUrl,\n    lang: state.intl.locale\n  };\n}, {\n  getVocabulary\n}))(ArrayWidget);","map":{"version":3,"names":["React","Component","defineMessages","injectIntl","PropTypes","compose","connect","injectLazyLibs","getVocabFromHint","getVocabFromField","getVocabFromItems","getVocabulary","Option","DropdownIndicator","ClearIndicator","selectTheme","customSelectStyles","MenuList","SortableMultiValue","SortableMultiValueLabel","FormFieldWrapper","messages","select","no_value","no_options","arrayMove","array","from","to","slicedArray","slice","splice","length","normalizeArrayValue","choices","value","Array","isArray","map","v","label","c","Object","keys","includes","item","token","title","filter","f","normalizeChoices","option","compareOption","inputValue","accessors","candidate","String","optionValue","getOptionValue","optionLabel","getOptionLabel","ArrayWidget","constructor","props","selectedOption","oldIndex","newIndex","newValue","handleChange","bind","componentDidMount","items","vocabBaseUrl","vocabNameOrURL","size","subrequest","lang","componentDidUpdate","vocabLoading","undefined","vocabLoaded","onChange","id","render","CreatableSelect","reactSelectCreateable","default","SortableContainer","reactSortableHOC","Select","reactSelect","SortableSelect","creatable","onSortEnd","node","getBoundingClientRect","disabled","isDisabled","noValueOption","intl","formatMessage","MultiValue","MultiValueLabel","placeholder","selectValue","selectOptions","some","string","isRequired","description","required","bool","error","arrayOf","func","oneOfType","object","shape","vocabulary","widgetOptions","wrapped","ArrayWidgetComponent","state","vocabState","vocabularies","subrequests","locale","loading","loaded"],"sources":["/home/jakob/workspace/training-project/node_modules/@plone/volto/src/components/manage/Widgets/ArrayWidget.jsx"],"sourcesContent":["/**\n * ArrayWidget component.\n * @module components/manage/Widgets/ArrayWidget\n */\n\nimport React, { Component } from 'react';\nimport { defineMessages, injectIntl } from 'react-intl';\nimport PropTypes from 'prop-types';\nimport { compose } from 'redux';\nimport { connect } from 'react-redux';\nimport { injectLazyLibs } from '@plone/volto/helpers/Loadable/Loadable';\nimport { find, isObject } from 'lodash';\n\nimport {\n  getVocabFromHint,\n  getVocabFromField,\n  getVocabFromItems,\n} from '@plone/volto/helpers';\nimport { getVocabulary } from '@plone/volto/actions';\n\nimport {\n  Option,\n  DropdownIndicator,\n  ClearIndicator,\n  selectTheme,\n  customSelectStyles,\n  MenuList,\n  SortableMultiValue,\n  SortableMultiValueLabel,\n} from '@plone/volto/components/manage/Widgets/SelectStyling';\n\nimport { FormFieldWrapper } from '@plone/volto/components';\n\nconst messages = defineMessages({\n  select: {\n    id: 'Select…',\n    defaultMessage: 'Select…',\n  },\n  no_value: {\n    id: 'No value',\n    defaultMessage: 'No value',\n  },\n  no_options: {\n    id: 'No options',\n    defaultMessage: 'No options',\n  },\n});\n\nfunction arrayMove(array, from, to) {\n  const slicedArray = array.slice();\n  slicedArray.splice(\n    to < 0 ? array.length + to : to,\n    0,\n    slicedArray.splice(from, 1)[0],\n  );\n  return slicedArray;\n}\n\nfunction normalizeArrayValue(choices, value) {\n  if (!value || !Array.isArray(value)) return [];\n  if (value.length === 0) return value;\n\n  if (typeof value[0] === 'string') {\n    // raw value like ['foo', 'bar']\n    return value.map((v) => {\n      return {\n        label: find(choices, (c) => c.value === v)?.label || v,\n        value: v,\n      };\n    });\n  }\n\n  if (\n    isObject(value[0]) &&\n    Object.keys(value[0]).includes('token') // Array of objects, w/ label+value\n  ) {\n    return value\n      .map((v) => {\n        const item = find(choices, (c) => c.value === v.token);\n        return item\n          ? {\n              label: item.label || item.title || item.token,\n              value: v.token,\n            }\n          : {\n              // avoid a crash if choices doesn't include this item\n              label: v.label,\n              value: v.token,\n            };\n      })\n      .filter((f) => !!f);\n  }\n\n  return [];\n}\n\nfunction normalizeChoices(choices) {\n  if (Array.isArray(choices) && choices.length && Array.isArray(choices[0])) {\n    return choices.map((option) => ({\n      value: option[0],\n      label:\n        // Fix \"None\" on the serializer, to remove when fixed in p.restapi\n        option[1] !== 'None' && option[1] ? option[1] : option[0],\n    }));\n  }\n\n  return choices;\n}\n\n/**\n * Compare values and return true if equal.\n * Consider upper and lower case.\n * @method compareOption\n * @param {*} inputValue\n * @param {*} option\n * @param {*} accessors\n * @returns {boolean}\n */\nconst compareOption = (inputValue = '', option, accessors) => {\n  const candidate = String(inputValue);\n  const optionValue = String(accessors.getOptionValue(option));\n  const optionLabel = String(accessors.getOptionLabel(option));\n  return optionValue === candidate || optionLabel === candidate;\n};\n\n/**\n * ArrayWidget component class.\n * @class ArrayWidget\n * @extends Component\n *\n * A createable select array widget will be rendered if the named vocabulary is\n * in the widget definition (hint) like:\n *\n * ```\n * list_field_voc_unconstrained = schema.List(\n *     title=u\"List field with values from vocabulary but not constrained to them.\",\n *     description=u\"zope.schema.List\",\n *     value_type=schema.TextLine(),\n *     required=False,\n *     missing_value=[],\n * )\n * directives.widget(\n *     \"list_field_voc_unconstrained\",\n *     AjaxSelectFieldWidget,\n *     vocabulary=\"plone.app.vocabularies.PortalTypes\",\n * )\n * ```\n */\nclass ArrayWidget extends Component {\n  /**\n   * Property types.\n   * @property {Object} propTypes Property types.\n   * @static\n   */\n  static propTypes = {\n    id: PropTypes.string.isRequired,\n    title: PropTypes.string.isRequired,\n    description: PropTypes.string,\n    required: PropTypes.bool,\n    error: PropTypes.arrayOf(PropTypes.string),\n    getVocabulary: PropTypes.func.isRequired,\n    choices: PropTypes.arrayOf(\n      PropTypes.oneOfType([PropTypes.object, PropTypes.array]),\n    ),\n    vocabLoading: PropTypes.bool,\n    vocabLoaded: PropTypes.bool,\n    items: PropTypes.shape({\n      vocabulary: PropTypes.object,\n    }),\n    widgetOptions: PropTypes.shape({\n      vocabulary: PropTypes.object,\n    }),\n    value: PropTypes.arrayOf(\n      PropTypes.oneOfType([PropTypes.object, PropTypes.string]),\n    ),\n    placeholder: PropTypes.string,\n    onChange: PropTypes.func.isRequired,\n    wrapped: PropTypes.bool,\n    creatable: PropTypes.bool, //if widget has no vocab and you want to be creatable\n  };\n\n  /**\n   * Default properties\n   * @property {Object} defaultProps Default properties.\n   * @static\n   */\n  static defaultProps = {\n    description: null,\n    required: false,\n    items: {\n      vocabulary: null,\n    },\n    widgetOptions: {\n      vocabulary: null,\n    },\n    error: [],\n    choices: [],\n    value: null,\n    creatable: false,\n  };\n\n  /**\n   * Constructor\n   * @method constructor\n   * @param {Object} props Component properties\n   * @constructs Actions\n   */\n  constructor(props) {\n    super(props);\n\n    this.handleChange = this.handleChange.bind(this);\n  }\n\n  /**\n   * Component did mount\n   * @method componentDidMount\n   * @returns {undefined}\n   */\n  componentDidMount() {\n    if (\n      !this.props.items?.choices?.length &&\n      !this.props.choices?.length &&\n      this.props.vocabBaseUrl\n    ) {\n      this.props.getVocabulary({\n        vocabNameOrURL: this.props.vocabBaseUrl,\n        size: -1,\n        subrequest: this.props.lang,\n      });\n    }\n  }\n\n  componentDidUpdate() {\n    if (\n      !this.props.items?.choices?.length &&\n      !this.props.choices?.length &&\n      this.props.vocabLoading === undefined &&\n      !this.props.vocabLoaded\n    ) {\n      this.props.getVocabulary({\n        vocabNameOrURL: this.props.vocabBaseUrl,\n        size: -1,\n        subrequest: this.props.lang,\n      });\n    }\n  }\n\n  /**\n   * Handle the field change, store it in the local state and back to simple\n   * array of tokens for correct serialization\n   * @method handleChange\n   * @param {array} selectedOption The selected options (already aggregated).\n   * @returns {undefined}\n   */\n  handleChange(selectedOption) {\n    this.props.onChange(\n      this.props.id,\n      selectedOption ? selectedOption.map((item) => item.value) : null,\n    );\n  }\n\n  onSortEnd = (selectedOption, { oldIndex, newIndex }) => {\n    const newValue = arrayMove(selectedOption, oldIndex, newIndex);\n\n    this.handleChange(newValue);\n  };\n\n  /**\n   * Render method.\n   * @method render\n   * @returns {string} Markup for the component.\n   */\n  render() {\n    const choices = normalizeChoices(this.props?.choices || []);\n    const selectedOption = normalizeArrayValue(choices, this.props.value);\n\n    const CreatableSelect = this.props.reactSelectCreateable.default;\n    const { SortableContainer } = this.props.reactSortableHOC;\n    const Select = this.props.reactSelect.default;\n    const SortableSelect =\n      // It will be only createable if the named vocabulary is in the widget definition\n      // (hint) like:\n      // list_field_voc_unconstrained = schema.List(\n      //     title=u\"List field with values from vocabulary but not constrained to them.\",\n      //     description=u\"zope.schema.List\",\n      //     value_type=schema.TextLine(),\n      //     required=False,\n      //     missing_value=[],\n      // )\n      // directives.widget(\n      //     \"list_field_voc_unconstrained\",\n      //     AjaxSelectFieldWidget,\n      //     vocabulary=\"plone.app.vocabularies.PortalTypes\",\n      // )\n      this.props?.choices &&\n      !getVocabFromHint(this.props) &&\n      !this.props.creatable\n        ? SortableContainer(Select)\n        : SortableContainer(CreatableSelect);\n\n    return (\n      <FormFieldWrapper {...this.props}>\n        <SortableSelect\n          useDragHandle\n          // react-sortable-hoc props:\n          axis=\"xy\"\n          onSortEnd={this.onSortEnd}\n          distance={4}\n          // small fix for https://github.com/clauderic/react-sortable-hoc/pull/352:\n          getHelperDimensions={({ node }) => node.getBoundingClientRect()}\n          id={`field-${this.props.id}`}\n          key={this.props.id}\n          isDisabled={this.props.disabled || this.props.isDisabled}\n          className=\"react-select-container\"\n          classNamePrefix=\"react-select\"\n          options={\n            this.props.vocabBaseUrl\n              ? choices\n              : this.props.choices\n              ? [\n                  ...choices,\n                  ...(this.props.noValueOption && !this.props.default\n                    ? [\n                        {\n                          label: this.props.intl.formatMessage(\n                            messages.no_value,\n                          ),\n                          value: 'no-value',\n                        },\n                      ]\n                    : []),\n                ]\n              : [\n                  {\n                    label: this.props.intl.formatMessage(messages.no_value),\n                    value: 'no-value',\n                  },\n                ]\n          }\n          styles={customSelectStyles}\n          theme={selectTheme}\n          components={{\n            ...(this.props.choices?.length > 25 && {\n              MenuList,\n            }),\n            MultiValue: SortableMultiValue,\n            MultiValueLabel: SortableMultiValueLabel,\n            DropdownIndicator,\n            ClearIndicator,\n            Option,\n          }}\n          value={selectedOption || []}\n          placeholder={\n            this.props.placeholder ??\n            this.props.intl.formatMessage(messages.select)\n          }\n          onChange={this.handleChange}\n          isValidNewOption={(\n            inputValue,\n            selectValue,\n            selectOptions,\n            accessors,\n          ) =>\n            !(\n              !inputValue ||\n              selectValue.some((option) =>\n                compareOption(inputValue, option, accessors),\n              ) ||\n              selectOptions.some((option) =>\n                compareOption(inputValue, option, accessors),\n              )\n            )\n          }\n          isClearable\n          isMulti\n        />\n      </FormFieldWrapper>\n    );\n  }\n}\n\nexport const ArrayWidgetComponent = injectIntl(ArrayWidget);\n\nexport default compose(\n  injectIntl,\n  injectLazyLibs(['reactSelect', 'reactSelectCreateable', 'reactSortableHOC']),\n  connect(\n    (state, props) => {\n      const vocabBaseUrl =\n        getVocabFromHint(props) ||\n        getVocabFromField(props) ||\n        getVocabFromItems(props);\n\n      const vocabState =\n        state.vocabularies?.[vocabBaseUrl]?.subrequests?.[state.intl.locale];\n\n      // If the schema already has the choices in it, then do not try to get the vocab,\n      // even if there is one\n      if (props.items?.choices) {\n        return {\n          choices: props.items.choices,\n          lang: state.intl.locale,\n        };\n      } else if (vocabState) {\n        return {\n          choices: vocabState.items,\n          vocabBaseUrl,\n          vocabLoading: vocabState.loading,\n          vocabLoaded: vocabState.loaded,\n          lang: state.intl.locale,\n        };\n      }\n      return { vocabBaseUrl, lang: state.intl.locale };\n    },\n    { getVocabulary },\n  ),\n)(ArrayWidget);\n"],"mappings":";;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AAEA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,cAAT,EAAyBC,UAAzB,QAA2C,YAA3C;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,SAASC,OAAT,QAAwB,OAAxB;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,SAASC,cAAT,QAA+B,wCAA/B;AAGA,SACEC,gBADF,EAEEC,iBAFF,EAGEC,iBAHF,QAIO,sBAJP;AAKA,SAASC,aAAT,QAA8B,sBAA9B;AAEA,SACEC,MADF,EAEEC,iBAFF,EAGEC,cAHF,EAIEC,WAJF,EAKEC,kBALF,EAMEC,QANF,EAOEC,kBAPF,EAQEC,uBARF,QASO,sDATP;AAWA,SAASC,gBAAT,QAAiC,yBAAjC;AAEA,MAAMC,QAAQ,GAAGnB,cAAc,CAAC;EAC9BoB,MAAM;IAAA;IAAA;EAAA,CADwB;EAK9BC,QAAQ;IAAA;IAAA;EAAA,CALsB;EAS9BC,UAAU;IAAA;IAAA;EAAA;AAToB,CAAD,CAA/B;;AAeA,SAASC,SAAT,CAAmBC,KAAnB,EAA0BC,IAA1B,EAAgCC,EAAhC,EAAoC;EAClC,MAAMC,WAAW,GAAGH,KAAK,CAACI,KAAN,EAApB;EACAD,WAAW,CAACE,MAAZ,CACEH,EAAE,GAAG,CAAL,GAASF,KAAK,CAACM,MAAN,GAAeJ,EAAxB,GAA6BA,EAD/B,EAEE,CAFF,EAGEC,WAAW,CAACE,MAAZ,CAAmBJ,IAAnB,EAAyB,CAAzB,EAA4B,CAA5B,CAHF;EAKA,OAAOE,WAAP;AACD;;AAED,SAASI,mBAAT,CAA6BC,OAA7B,EAAsCC,KAAtC,EAA6C;EAC3C,IAAI,CAACA,KAAD,IAAU,CAACC,KAAK,CAACC,OAAN,CAAcF,KAAd,CAAf,EAAqC,OAAO,EAAP;EACrC,IAAIA,KAAK,CAACH,MAAN,KAAiB,CAArB,EAAwB,OAAOG,KAAP;;EAExB,IAAI,OAAOA,KAAK,CAAC,CAAD,CAAZ,KAAoB,QAAxB,EAAkC;IAChC;IACA,OAAOA,KAAK,CAACG,GAAN,CAAWC,CAAD,IAAO;MAAA;;MACtB,OAAO;QACLC,KAAK,EAAE,iBAAKN,OAAL,EAAeO,CAAD,IAAOA,CAAC,CAACN,KAAF,KAAYI,CAAjC,mDAAqCC,KAArC,KAA8CD,CADhD;QAELJ,KAAK,EAAEI;MAFF,CAAP;IAID,CALM,CAAP;EAMD;;EAED,IACE,UAASJ,KAAK,CAAC,CAAD,CAAd,KACAO,MAAM,CAACC,IAAP,CAAYR,KAAK,CAAC,CAAD,CAAjB,EAAsBS,QAAtB,CAA+B,OAA/B,CAFF,CAE0C;EAF1C,EAGE;IACA,OAAOT,KAAK,CACTG,GADI,CACCC,CAAD,IAAO;MACV,MAAMM,IAAI,GAAG,MAAKX,OAAL,EAAeO,CAAD,IAAOA,CAAC,CAACN,KAAF,KAAYI,CAAC,CAACO,KAAnC,CAAb;;MACA,OAAOD,IAAI,GACP;QACEL,KAAK,EAAEK,IAAI,CAACL,KAAL,IAAcK,IAAI,CAACE,KAAnB,IAA4BF,IAAI,CAACC,KAD1C;QAEEX,KAAK,EAAEI,CAAC,CAACO;MAFX,CADO,GAKP;QACE;QACAN,KAAK,EAAED,CAAC,CAACC,KAFX;QAGEL,KAAK,EAAEI,CAAC,CAACO;MAHX,CALJ;IAUD,CAbI,EAcJE,MAdI,CAcIC,CAAD,IAAO,CAAC,CAACA,CAdZ,CAAP;EAeD;;EAED,OAAO,EAAP;AACD;;AAED,SAASC,gBAAT,CAA0BhB,OAA1B,EAAmC;EACjC,IAAIE,KAAK,CAACC,OAAN,CAAcH,OAAd,KAA0BA,OAAO,CAACF,MAAlC,IAA4CI,KAAK,CAACC,OAAN,CAAcH,OAAO,CAAC,CAAD,CAArB,CAAhD,EAA2E;IACzE,OAAOA,OAAO,CAACI,GAAR,CAAaa,MAAD,KAAa;MAC9BhB,KAAK,EAAEgB,MAAM,CAAC,CAAD,CADiB;MAE9BX,KAAK,EACH;MACAW,MAAM,CAAC,CAAD,CAAN,KAAc,MAAd,IAAwBA,MAAM,CAAC,CAAD,CAA9B,GAAoCA,MAAM,CAAC,CAAD,CAA1C,GAAgDA,MAAM,CAAC,CAAD;IAJ1B,CAAb,CAAZ,CAAP;EAMD;;EAED,OAAOjB,OAAP;AACD;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,MAAMkB,aAAa,GAAG,CAACC,UAAU,GAAG,EAAd,EAAkBF,MAAlB,EAA0BG,SAA1B,KAAwC;EAC5D,MAAMC,SAAS,GAAGC,MAAM,CAACH,UAAD,CAAxB;EACA,MAAMI,WAAW,GAAGD,MAAM,CAACF,SAAS,CAACI,cAAV,CAAyBP,MAAzB,CAAD,CAA1B;EACA,MAAMQ,WAAW,GAAGH,MAAM,CAACF,SAAS,CAACM,cAAV,CAAyBT,MAAzB,CAAD,CAA1B;EACA,OAAOM,WAAW,KAAKF,SAAhB,IAA6BI,WAAW,KAAKJ,SAApD;AACD,CALD;AAOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,MAAMM,WAAN,SAA0B5D,SAA1B,CAAoC;EAClC;AACF;AACA;AACA;AACA;;EA4BE;AACF;AACA;AACA;AACA;;EAgBE;AACF;AACA;AACA;AACA;AACA;EACE6D,WAAW,CAACC,KAAD,EAAQ;IACjB,MAAMA,KAAN;;IADiB,mCAsDP,CAACC,cAAD,EAAiB;MAAEC,QAAF;MAAYC;IAAZ,CAAjB,KAA4C;MACtD,MAAMC,QAAQ,GAAG1C,SAAS,CAACuC,cAAD,EAAiBC,QAAjB,EAA2BC,QAA3B,CAA1B;MAEA,KAAKE,YAAL,CAAkBD,QAAlB;IACD,CA1DkB;;IAGjB,KAAKC,YAAL,GAAoB,KAAKA,YAAL,CAAkBC,IAAlB,CAAuB,IAAvB,CAApB;EACD;EAED;AACF;AACA;AACA;AACA;;;EACEC,iBAAiB,GAAG;IAAA;;IAClB,IACE,uBAAC,KAAKP,KAAL,CAAWQ,KAAZ,uEAAC,kBAAkBrC,OAAnB,kDAAC,sBAA2BF,MAA5B,KACA,yBAAC,KAAK+B,KAAL,CAAW7B,OAAZ,gDAAC,oBAAoBF,MAArB,CADA,IAEA,KAAK+B,KAAL,CAAWS,YAHb,EAIE;MACA,KAAKT,KAAL,CAAWpD,aAAX,CAAyB;QACvB8D,cAAc,EAAE,KAAKV,KAAL,CAAWS,YADJ;QAEvBE,IAAI,EAAE,CAAC,CAFgB;QAGvBC,UAAU,EAAE,KAAKZ,KAAL,CAAWa;MAHA,CAAzB;IAKD;EACF;;EAEDC,kBAAkB,GAAG;IAAA;;IACnB,IACE,wBAAC,KAAKd,KAAL,CAAWQ,KAAZ,wEAAC,mBAAkBrC,OAAnB,kDAAC,sBAA2BF,MAA5B,KACA,0BAAC,KAAK+B,KAAL,CAAW7B,OAAZ,iDAAC,qBAAoBF,MAArB,CADA,IAEA,KAAK+B,KAAL,CAAWe,YAAX,KAA4BC,SAF5B,IAGA,CAAC,KAAKhB,KAAL,CAAWiB,WAJd,EAKE;MACA,KAAKjB,KAAL,CAAWpD,aAAX,CAAyB;QACvB8D,cAAc,EAAE,KAAKV,KAAL,CAAWS,YADJ;QAEvBE,IAAI,EAAE,CAAC,CAFgB;QAGvBC,UAAU,EAAE,KAAKZ,KAAL,CAAWa;MAHA,CAAzB;IAKD;EACF;EAED;AACF;AACA;AACA;AACA;AACA;AACA;;;EACER,YAAY,CAACJ,cAAD,EAAiB;IAC3B,KAAKD,KAAL,CAAWkB,QAAX,CACE,KAAKlB,KAAL,CAAWmB,EADb,EAEElB,cAAc,GAAGA,cAAc,CAAC1B,GAAf,CAAoBO,IAAD,IAAUA,IAAI,CAACV,KAAlC,CAAH,GAA8C,IAF9D;EAID;;EAQD;AACF;AACA;AACA;AACA;EACEgD,MAAM,GAAG;IAAA;;IACP,MAAMjD,OAAO,GAAGgB,gBAAgB,CAAC,qBAAKa,KAAL,4DAAY7B,OAAZ,KAAuB,EAAxB,CAAhC;IACA,MAAM8B,cAAc,GAAG/B,mBAAmB,CAACC,OAAD,EAAU,KAAK6B,KAAL,CAAW5B,KAArB,CAA1C;IAEA,MAAMiD,eAAe,GAAG,KAAKrB,KAAL,CAAWsB,qBAAX,CAAiCC,OAAzD;IACA,MAAM;MAAEC;IAAF,IAAwB,KAAKxB,KAAL,CAAWyB,gBAAzC;IACA,MAAMC,MAAM,GAAG,KAAK1B,KAAL,CAAW2B,WAAX,CAAuBJ,OAAtC;IACA,MAAMK,cAAc,GAClB;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA,qBAAK5B,KAAL,sDAAY7B,OAAZ,IACA,CAAC1B,gBAAgB,CAAC,KAAKuD,KAAN,CADjB,IAEA,CAAC,KAAKA,KAAL,CAAW6B,SAFZ,GAGIL,iBAAiB,CAACE,MAAD,CAHrB,GAIIF,iBAAiB,CAACH,eAAD,CAnBvB;IAqBA,OACE,MAAC,gBAAD,eAAsB,KAAKrB,KAA3B;MAAA;MAAA;QAAA;QAAA;QAAA;MAAA;IAAA,IACE,MAAC,cAAD;MACE,aAAa,MADf,CAEE;MAFF;MAGE,IAAI,EAAC,IAHP;MAIE,SAAS,EAAE,KAAK8B,SAJlB;MAKE,QAAQ,EAAE,CALZ,CAME;MANF;MAOE,mBAAmB,EAAE,CAAC;QAAEC;MAAF,CAAD,KAAcA,IAAI,CAACC,qBAAL,EAPrC;MAQE,EAAE,EAAG,SAAQ,KAAKhC,KAAL,CAAWmB,EAAG,EAR7B;MASE,GAAG,EAAE,KAAKnB,KAAL,CAAWmB,EATlB;MAUE,UAAU,EAAE,KAAKnB,KAAL,CAAWiC,QAAX,IAAuB,KAAKjC,KAAL,CAAWkC,UAVhD;MAWE,SAAS,EAAC,wBAXZ;MAYE,eAAe,EAAC,cAZlB;MAaE,OAAO,EACL,KAAKlC,KAAL,CAAWS,YAAX,GACItC,OADJ,GAEI,KAAK6B,KAAL,CAAW7B,OAAX,GACA,CACE,GAAGA,OADL,EAEE,IAAI,KAAK6B,KAAL,CAAWmC,aAAX,IAA4B,CAAC,KAAKnC,KAAL,CAAWuB,OAAxC,GACA,CACE;QACE9C,KAAK,EAAE,KAAKuB,KAAL,CAAWoC,IAAX,CAAgBC,aAAhB,CACL/E,QAAQ,CAACE,QADJ,CADT;QAIEY,KAAK,EAAE;MAJT,CADF,CADA,GASA,EATJ,CAFF,CADA,GAcA,CACE;QACEK,KAAK,EAAE,KAAKuB,KAAL,CAAWoC,IAAX,CAAgBC,aAAhB,CAA8B/E,QAAQ,CAACE,QAAvC,CADT;QAEEY,KAAK,EAAE;MAFT,CADF,CA9BR;MAqCE,MAAM,EAAEnB,kBArCV;MAsCE,KAAK,EAAED,WAtCT;MAuCE,UAAU,kCACJ,8BAAKgD,KAAL,CAAW7B,OAAX,8EAAoBF,MAApB,IAA6B,EAA7B,IAAmC;QACrCf;MADqC,CAD/B;QAIRoF,UAAU,EAAEnF,kBAJJ;QAKRoF,eAAe,EAAEnF,uBALT;QAMRN,iBANQ;QAORC,cAPQ;QAQRF;MARQ,EAvCZ;MAiDE,KAAK,EAAEoD,cAAc,IAAI,EAjD3B;MAkDE,WAAW,2BACT,KAAKD,KAAL,CAAWwC,WADF,yEAET,KAAKxC,KAAL,CAAWoC,IAAX,CAAgBC,aAAhB,CAA8B/E,QAAQ,CAACC,MAAvC,CApDJ;MAsDE,QAAQ,EAAE,KAAK8C,YAtDjB;MAuDE,gBAAgB,EAAE,CAChBf,UADgB,EAEhBmD,WAFgB,EAGhBC,aAHgB,EAIhBnD,SAJgB,KAMhB,EACE,CAACD,UAAD,IACAmD,WAAW,CAACE,IAAZ,CAAkBvD,MAAD,IACfC,aAAa,CAACC,UAAD,EAAaF,MAAb,EAAqBG,SAArB,CADf,CADA,IAIAmD,aAAa,CAACC,IAAd,CAAoBvD,MAAD,IACjBC,aAAa,CAACC,UAAD,EAAaF,MAAb,EAAqBG,SAArB,CADf,CALF,CA7DJ;MAuEE,WAAW,MAvEb;MAwEE,OAAO,MAxET;MAAA;MAAA;QAAA;QAAA;QAAA;MAAA;IAAA,EADF,CADF;EA8ED;;AAtOiC;;gBAA9BO,W,eAMe;EACjBqB,EAAE,EAAE9E,SAAS,CAACuG,MAAV,CAAiBC,UADJ;EAEjB7D,KAAK,EAAE3C,SAAS,CAACuG,MAAV,CAAiBC,UAFP;EAGjBC,WAAW,EAAEzG,SAAS,CAACuG,MAHN;EAIjBG,QAAQ,EAAE1G,SAAS,CAAC2G,IAJH;EAKjBC,KAAK,EAAE5G,SAAS,CAAC6G,OAAV,CAAkB7G,SAAS,CAACuG,MAA5B,CALU;EAMjBhG,aAAa,EAAEP,SAAS,CAAC8G,IAAV,CAAeN,UANb;EAOjB1E,OAAO,EAAE9B,SAAS,CAAC6G,OAAV,CACP7G,SAAS,CAAC+G,SAAV,CAAoB,CAAC/G,SAAS,CAACgH,MAAX,EAAmBhH,SAAS,CAACsB,KAA7B,CAApB,CADO,CAPQ;EAUjBoD,YAAY,EAAE1E,SAAS,CAAC2G,IAVP;EAWjB/B,WAAW,EAAE5E,SAAS,CAAC2G,IAXN;EAYjBxC,KAAK,EAAEnE,SAAS,CAACiH,KAAV,CAAgB;IACrBC,UAAU,EAAElH,SAAS,CAACgH;EADD,CAAhB,CAZU;EAejBG,aAAa,EAAEnH,SAAS,CAACiH,KAAV,CAAgB;IAC7BC,UAAU,EAAElH,SAAS,CAACgH;EADO,CAAhB,CAfE;EAkBjBjF,KAAK,EAAE/B,SAAS,CAAC6G,OAAV,CACL7G,SAAS,CAAC+G,SAAV,CAAoB,CAAC/G,SAAS,CAACgH,MAAX,EAAmBhH,SAAS,CAACuG,MAA7B,CAApB,CADK,CAlBU;EAqBjBJ,WAAW,EAAEnG,SAAS,CAACuG,MArBN;EAsBjB1B,QAAQ,EAAE7E,SAAS,CAAC8G,IAAV,CAAeN,UAtBR;EAuBjBY,OAAO,EAAEpH,SAAS,CAAC2G,IAvBF;EAwBjBnB,SAAS,EAAExF,SAAS,CAAC2G,IAxBJ,CAwBU;;AAxBV,C;;gBANflD,W,kBAsCkB;EACpBgD,WAAW,EAAE,IADO;EAEpBC,QAAQ,EAAE,KAFU;EAGpBvC,KAAK,EAAE;IACL+C,UAAU,EAAE;EADP,CAHa;EAMpBC,aAAa,EAAE;IACbD,UAAU,EAAE;EADC,CANK;EASpBN,KAAK,EAAE,EATa;EAUpB9E,OAAO,EAAE,EAVW;EAWpBC,KAAK,EAAE,IAXa;EAYpByD,SAAS,EAAE;AAZS,C;;AAmMxB,OAAO,MAAM6B,oBAAoB,GAAGtH,UAAU,CAAC0D,WAAD,CAAvC;AAEP,eAAexD,OAAO,CACpBF,UADoB,EAEpBI,cAAc,CAAC,CAAC,aAAD,EAAgB,uBAAhB,EAAyC,kBAAzC,CAAD,CAFM,EAGpBD,OAAO,CACL,CAACoH,KAAD,EAAQ3D,KAAR,KAAkB;EAAA;;EAChB,MAAMS,YAAY,GAChBhE,gBAAgB,CAACuD,KAAD,CAAhB,IACAtD,iBAAiB,CAACsD,KAAD,CADjB,IAEArD,iBAAiB,CAACqD,KAAD,CAHnB;EAKA,MAAM4D,UAAU,0BACdD,KAAK,CAACE,YADQ,iFACd,oBAAqBpD,YAArB,CADc,oFACd,sBAAoCqD,WADtB,2DACd,uBAAkDH,KAAK,CAACvB,IAAN,CAAW2B,MAA7D,CADF,CANgB,CAShB;EACA;;EACA,oBAAI/D,KAAK,CAACQ,KAAV,yCAAI,aAAarC,OAAjB,EAA0B;IACxB,OAAO;MACLA,OAAO,EAAE6B,KAAK,CAACQ,KAAN,CAAYrC,OADhB;MAEL0C,IAAI,EAAE8C,KAAK,CAACvB,IAAN,CAAW2B;IAFZ,CAAP;EAID,CALD,MAKO,IAAIH,UAAJ,EAAgB;IACrB,OAAO;MACLzF,OAAO,EAAEyF,UAAU,CAACpD,KADf;MAELC,YAFK;MAGLM,YAAY,EAAE6C,UAAU,CAACI,OAHpB;MAIL/C,WAAW,EAAE2C,UAAU,CAACK,MAJnB;MAKLpD,IAAI,EAAE8C,KAAK,CAACvB,IAAN,CAAW2B;IALZ,CAAP;EAOD;;EACD,OAAO;IAAEtD,YAAF;IAAgBI,IAAI,EAAE8C,KAAK,CAACvB,IAAN,CAAW2B;EAAjC,CAAP;AACD,CA3BI,EA4BL;EAAEnH;AAAF,CA5BK,CAHa,CAAP,CAiCbkD,WAjCa,CAAf"},"metadata":{"react-intl":{"messages":[{"id":"Select…","defaultMessage":"Select…"},{"id":"No value","defaultMessage":"No value"},{"id":"No options","defaultMessage":"No options"}]}},"sourceType":"module"}