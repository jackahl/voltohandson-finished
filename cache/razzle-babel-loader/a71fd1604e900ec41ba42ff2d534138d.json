{"ast":null,"code":"import _isEmpty from \"lodash/isEmpty\";\nvar _jsxFileName = \"/home/jakob/workspace/training-project/node_modules/@plone/volto/src/components/manage/DragDropList/DragDropList.jsx\";\nvar __jsx = React.createElement;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useRef } from 'react';\nimport { injectLazyLibs } from '@plone/volto/helpers/Loadable/Loadable';\nimport { v4 as uuid } from 'uuid';\n\nconst getPlaceholder = (draggedDOM, sourceIndex, destinationIndex) => {\n  // Because of the margin rendering rules, there is no easy\n  // way to calculate the offset of the placeholder.\n  //\n  // (Note that this is the reason we cannot use the solutions\n  // published on the net, because they assume that we are in control\n  // of the content and there are no additional margins involved.)\n  //\n  // To get a placeholder that looks good in all cases, we\n  // fill up the space between the previous and the next element.\n  const childrenArray = [...draggedDOM.parentNode.children]; // Remove the source element\n\n  childrenArray.splice(sourceIndex, 1); // Also remove the placeholder that the library always inserts at the end\n\n  childrenArray.splice(-1, 1);\n  const parentRect = draggedDOM.parentNode.getBoundingClientRect();\n  const prevNode = childrenArray[destinationIndex - 1];\n  const nextNode = childrenArray[destinationIndex];\n  let top, bottom;\n\n  if (prevNode) {\n    const prevRect = prevNode.getBoundingClientRect();\n    top = prevRect.top + prevRect.height - parentRect.top;\n  } else {\n    top = 0;\n  }\n\n  if (nextNode) {\n    const nextRect = nextNode.getBoundingClientRect();\n    bottom = nextRect.top - parentRect.top;\n  } else {\n    bottom = parentRect.bottom + draggedDOM.getBoundingClientRect().height - parentRect.top;\n  }\n\n  return {\n    clientY: top,\n    clientHeight: bottom - top,\n    clientX: parseFloat(window.getComputedStyle(draggedDOM.parentNode).paddingLeft),\n    clientWidth: draggedDOM.clientWidth\n  };\n};\n\nconst DragDropList = props => {\n  const {\n    childList,\n    children,\n    onMoveItem,\n    as = 'div',\n    style,\n    forwardedAriaLabelledBy,\n    reactBeautifulDnd\n  } = props; //renderChild\n\n  const {\n    DragDropContext,\n    Draggable,\n    Droppable\n  } = reactBeautifulDnd;\n  const [placeholderProps, setPlaceholderProps] = React.useState({});\n  const [uid] = React.useState(uuid()); // queueing timed action\n\n  const timer = useRef(null);\n  const onDragStart = React.useCallback(event => {\n    clearTimeout(timer.current);\n    const queryAttr = 'data-rbd-draggable-id';\n    const domQuery = `[${queryAttr}='${event.draggableId}']`;\n    const draggedDOM = document.querySelector(domQuery);\n\n    if (!draggedDOM) {\n      return;\n    }\n\n    const sourceIndex = event.source.index;\n    setPlaceholderProps(getPlaceholder(draggedDOM, sourceIndex, sourceIndex));\n  }, []);\n  const onDragEnd = React.useCallback(result => {\n    clearTimeout(timer.current);\n    onMoveItem(result);\n    setPlaceholderProps({});\n  }, [onMoveItem]);\n  const onDragUpdate = React.useCallback(update => {\n    clearTimeout(timer.current);\n    setPlaceholderProps({});\n\n    if (!update.destination) {\n      return;\n    }\n\n    const draggableId = update.draggableId;\n    const queryAttr = 'data-rbd-draggable-id';\n    const domQuery = `[${queryAttr}='${draggableId}']`;\n    const draggedDOM = document.querySelector(domQuery);\n\n    if (!draggedDOM) {\n      return;\n    }\n\n    const sourceIndex = update.source.index;\n    const destinationIndex = update.destination.index; // Wait until the animations have finished, to make it look good.\n\n    timer.current = setTimeout(() => setPlaceholderProps(getPlaceholder(draggedDOM, sourceIndex, destinationIndex)), 250);\n  }, []);\n  const AsDomComponent = as;\n  return __jsx(DragDropContext, {\n    onDragStart: onDragStart,\n    onDragUpdate: onDragUpdate,\n    onDragEnd: onDragEnd,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 5\n    }\n  }, __jsx(Droppable, {\n    droppableId: uid,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 7\n    }\n  }, (provided, snapshot) => __jsx(AsDomComponent, _extends({\n    ref: provided.innerRef\n  }, provided.droppableProps, {\n    style: _objectSpread(_objectSpread({}, style), {}, {\n      position: 'relative'\n    }),\n    \"aria-labelledby\": forwardedAriaLabelledBy,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 11\n    }\n  }), childList.filter(([id, child]) => id && child) // beware numbers!\n  .map(([childId, child], index) => __jsx(Draggable, {\n    draggableId: childId.toString(),\n    index: index,\n    key: childId,\n    style: {\n      userSelect: 'none'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 17\n    }\n  }, draginfo => children({\n    child,\n    childId,\n    index,\n    draginfo\n  }))), provided.placeholder, !_isEmpty(placeholderProps) && snapshot.isDraggingOver && __jsx(\"div\", {\n    style: {\n      position: 'absolute',\n      top: placeholderProps.clientY,\n      left: placeholderProps.clientX,\n      height: placeholderProps.clientHeight,\n      background: '#eee',\n      width: placeholderProps.clientWidth,\n      borderRadius: '3px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 15\n    }\n  }))));\n};\n\nexport default injectLazyLibs(['reactBeautifulDnd'])(DragDropList);","map":{"version":3,"names":["React","useRef","injectLazyLibs","v4","uuid","getPlaceholder","draggedDOM","sourceIndex","destinationIndex","childrenArray","parentNode","children","splice","parentRect","getBoundingClientRect","prevNode","nextNode","top","bottom","prevRect","height","nextRect","clientY","clientHeight","clientX","parseFloat","window","getComputedStyle","paddingLeft","clientWidth","DragDropList","props","childList","onMoveItem","as","style","forwardedAriaLabelledBy","reactBeautifulDnd","DragDropContext","Draggable","Droppable","placeholderProps","setPlaceholderProps","useState","uid","timer","onDragStart","useCallback","event","clearTimeout","current","queryAttr","domQuery","draggableId","document","querySelector","source","index","onDragEnd","result","onDragUpdate","update","destination","setTimeout","AsDomComponent","provided","snapshot","innerRef","droppableProps","position","filter","id","child","map","childId","toString","userSelect","draginfo","placeholder","isDraggingOver","left","background","width","borderRadius"],"sources":["/home/jakob/workspace/training-project/node_modules/@plone/volto/src/components/manage/DragDropList/DragDropList.jsx"],"sourcesContent":["import React, { useRef } from 'react';\nimport { isEmpty } from 'lodash';\nimport { injectLazyLibs } from '@plone/volto/helpers/Loadable/Loadable';\nimport { v4 as uuid } from 'uuid';\n\nconst getPlaceholder = (draggedDOM, sourceIndex, destinationIndex) => {\n  // Because of the margin rendering rules, there is no easy\n  // way to calculate the offset of the placeholder.\n  //\n  // (Note that this is the reason we cannot use the solutions\n  // published on the net, because they assume that we are in control\n  // of the content and there are no additional margins involved.)\n  //\n  // To get a placeholder that looks good in all cases, we\n  // fill up the space between the previous and the next element.\n  const childrenArray = [...draggedDOM.parentNode.children];\n  // Remove the source element\n  childrenArray.splice(sourceIndex, 1);\n  // Also remove the placeholder that the library always inserts at the end\n  childrenArray.splice(-1, 1);\n  const parentRect = draggedDOM.parentNode.getBoundingClientRect();\n  const prevNode = childrenArray[destinationIndex - 1];\n  const nextNode = childrenArray[destinationIndex];\n  let top, bottom;\n  if (prevNode) {\n    const prevRect = prevNode.getBoundingClientRect();\n    top = prevRect.top + prevRect.height - parentRect.top;\n  } else {\n    top = 0;\n  }\n  if (nextNode) {\n    const nextRect = nextNode.getBoundingClientRect();\n    bottom = nextRect.top - parentRect.top;\n  } else {\n    bottom =\n      parentRect.bottom +\n      draggedDOM.getBoundingClientRect().height -\n      parentRect.top;\n  }\n  return {\n    clientY: top,\n    clientHeight: bottom - top,\n    clientX: parseFloat(\n      window.getComputedStyle(draggedDOM.parentNode).paddingLeft,\n    ),\n    clientWidth: draggedDOM.clientWidth,\n  };\n};\n\nconst DragDropList = (props) => {\n  const {\n    childList,\n    children,\n    onMoveItem,\n    as = 'div',\n    style,\n    forwardedAriaLabelledBy,\n    reactBeautifulDnd,\n  } = props; //renderChild\n  const { DragDropContext, Draggable, Droppable } = reactBeautifulDnd;\n  const [placeholderProps, setPlaceholderProps] = React.useState({});\n  const [uid] = React.useState(uuid());\n  // queueing timed action\n  const timer = useRef(null);\n\n  const onDragStart = React.useCallback((event) => {\n    clearTimeout(timer.current);\n    const queryAttr = 'data-rbd-draggable-id';\n    const domQuery = `[${queryAttr}='${event.draggableId}']`;\n    const draggedDOM = document.querySelector(domQuery);\n    if (!draggedDOM) {\n      return;\n    }\n    const sourceIndex = event.source.index;\n    setPlaceholderProps(getPlaceholder(draggedDOM, sourceIndex, sourceIndex));\n  }, []);\n\n  const onDragEnd = React.useCallback(\n    (result) => {\n      clearTimeout(timer.current);\n      onMoveItem(result);\n      setPlaceholderProps({});\n    },\n    [onMoveItem],\n  );\n\n  const onDragUpdate = React.useCallback((update) => {\n    clearTimeout(timer.current);\n    setPlaceholderProps({});\n    if (!update.destination) {\n      return;\n    }\n    const draggableId = update.draggableId;\n    const queryAttr = 'data-rbd-draggable-id';\n    const domQuery = `[${queryAttr}='${draggableId}']`;\n    const draggedDOM = document.querySelector(domQuery);\n    if (!draggedDOM) {\n      return;\n    }\n    const sourceIndex = update.source.index;\n    const destinationIndex = update.destination.index;\n    // Wait until the animations have finished, to make it look good.\n    timer.current = setTimeout(\n      () =>\n        setPlaceholderProps(\n          getPlaceholder(draggedDOM, sourceIndex, destinationIndex),\n        ),\n      250,\n    );\n  }, []);\n\n  const AsDomComponent = as;\n  return (\n    <DragDropContext\n      onDragStart={onDragStart}\n      onDragUpdate={onDragUpdate}\n      onDragEnd={onDragEnd}\n    >\n      <Droppable droppableId={uid}>\n        {(provided, snapshot) => (\n          <AsDomComponent\n            ref={provided.innerRef}\n            {...provided.droppableProps}\n            style={{ ...style, position: 'relative' }}\n            aria-labelledby={forwardedAriaLabelledBy}\n          >\n            {childList\n              .filter(([id, child]) => id && child) // beware numbers!\n              .map(([childId, child], index) => (\n                <Draggable\n                  draggableId={childId.toString()}\n                  index={index}\n                  key={childId}\n                  style={{\n                    userSelect: 'none',\n                  }}\n                >\n                  {(draginfo) => children({ child, childId, index, draginfo })}\n                </Draggable>\n              ))}\n            {provided.placeholder}\n            {!isEmpty(placeholderProps) && snapshot.isDraggingOver && (\n              <div\n                style={{\n                  position: 'absolute',\n                  top: placeholderProps.clientY,\n                  left: placeholderProps.clientX,\n                  height: placeholderProps.clientHeight,\n                  background: '#eee',\n                  width: placeholderProps.clientWidth,\n                  borderRadius: '3px',\n                }}\n              />\n            )}\n          </AsDomComponent>\n        )}\n      </Droppable>\n    </DragDropContext>\n  );\n};\n\nexport default injectLazyLibs(['reactBeautifulDnd'])(DragDropList);\n"],"mappings":"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"},"metadata":{"react-intl":{"messages":[]}},"sourceType":"module"}