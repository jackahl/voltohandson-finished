{"ast":null,"code":"import _map from \"lodash/map\";\nvar _jsxFileName = \"/home/jakob/workspace/training-project/node_modules/@plone/volto/src/components/manage/Multilingual/TranslationObject.jsx\";\nvar __jsx = React.createElement;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n/**\n * Add container.\n * @module components/manage/Add/Add\n */\nimport React, { useEffect, useState } from 'react';\nimport { defineMessages, useIntl } from 'react-intl';\nimport { Form as UiForm, Menu, Segment } from 'semantic-ui-react';\nimport { Provider } from 'react-intl-redux';\nimport { Form, Field } from '@plone/volto/components';\nimport config from '@plone/volto/registry';\nimport configureStore from '@plone/volto/store';\nimport { Api, flattenToAppURL, langmap, normalizeLanguageName } from '@plone/volto/helpers';\nimport { createBrowserHistory } from 'history';\nconst messages = defineMessages({\n  document: {\n    \"id\": \"Document\",\n    \"defaultMessage\": \"Document\"\n  }\n});\n/**\n * TranslationObject class.\n * @class TranslationObject\n * @extends Component\n */\n\nconst TranslationObject = ({\n  translationObject,\n  schema,\n  pathname,\n  visual,\n  isFormSelected,\n  onSelectForm\n}) => {\n  const intl = useIntl();\n  const {\n    0: locales,\n    1: setLocales\n  } = useState({});\n  const {\n    0: loadingLocale,\n    1: setLoadingLocale\n  } = useState(false);\n  const {\n    0: activeMenu,\n    1: setActiveMenu\n  } = useState('language');\n\n  const handleMenuClick = (e, {\n    name\n  }) => {\n    setActiveMenu(name);\n  };\n\n  useEffect(() => {\n    if (!loadingLocale && Object.keys(locales).length < config.settings.supportedLanguages.length) {\n      setLoadingLocale(true);\n      let lang = config.settings.supportedLanguages[Object.keys(locales).length];\n      const langFileName = normalizeLanguageName(lang);\n      import('@root/../locales/' + langFileName + '.json').then(locale => {\n        setLocales(_objectSpread(_objectSpread({}, locales), {}, {\n          [lang]: locale.default\n        }));\n        setLoadingLocale(false);\n      });\n    }\n  }, [loadingLocale, locales]);\n  const api = new Api();\n  const history = createBrowserHistory();\n  const store = configureStore(_objectSpread(_objectSpread({}, window.__data), {}, {\n    intl: {\n      defaultLocale: config.settings.defaultLanguage,\n      locale: translationObject.language.token,\n      messages: locales[translationObject.language.token]\n    }\n  }), history, api);\n  const lang = translationObject.language.token;\n  return translationObject && Object.keys(locales).length > 0 ? __jsx(Provider, {\n    store: store,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 5\n    }\n  }, __jsx(React.Fragment, null, __jsx(Menu, {\n    pointing: true,\n    secondary: true,\n    attached: true,\n    tabular: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 9\n    }\n  }, __jsx(Menu.Item, {\n    name: \"language\",\n    active: activeMenu === 'language',\n    onClick: handleMenuClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 11\n    }\n  }, langmap[lang].nativeName), visual && __jsx(Menu.Item, {\n    name: \"properties\",\n    active: activeMenu === 'properties',\n    onClick: handleMenuClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 13\n    }\n  }, intl.formatMessage(messages.document))), activeMenu === 'language' && __jsx(Form, {\n    key: \"translation-object-form\",\n    schema: schema,\n    formData: translationObject,\n    type: translationObject['@type'],\n    onSubmit: () => {\n      /*do nothing*/\n    },\n    hideActions: true,\n    pathname: flattenToAppURL(translationObject['@id']),\n    visual: visual,\n    title: langmap[lang].nativeName,\n    loading: false,\n    isFormSelected: isFormSelected,\n    onSelectForm: onSelectForm,\n    editable: false,\n    onChange: () => {},\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 11\n    }\n  }), activeMenu === 'properties' && __jsx(UiForm, {\n    method: \"post\",\n    onSubmit: () => {},\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 11\n    }\n  }, __jsx(\"fieldset\", {\n    className: \"invisible\",\n    disabled: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 13\n    }\n  }, schema && _map(schema.fieldsets, item => [__jsx(Segment, {\n    secondary: true,\n    attached: true,\n    key: item.title,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 19\n    }\n  }, item.title), __jsx(Segment, {\n    attached: true,\n    key: `fieldset-contents-${item.title}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 19\n    }\n  }, _map(item.fields, (field, index) => __jsx(Field, _extends({}, schema.properties[field], {\n    id: field,\n    formData: translationObject,\n    focus: false,\n    value: translationObject[field],\n    required: schema.required.indexOf(field) !== -1,\n    key: field,\n    onChange: () => {},\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 23\n    }\n  }))))]))))) : null;\n};\n\nexport default TranslationObject;","map":{"version":3,"names":["React","useEffect","useState","defineMessages","useIntl","Form","UiForm","Menu","Segment","Provider","Field","config","configureStore","Api","flattenToAppURL","langmap","normalizeLanguageName","createBrowserHistory","messages","document","TranslationObject","translationObject","schema","pathname","visual","isFormSelected","onSelectForm","intl","locales","setLocales","loadingLocale","setLoadingLocale","activeMenu","setActiveMenu","handleMenuClick","e","name","Object","keys","length","settings","supportedLanguages","lang","langFileName","then","locale","default","api","history","store","window","__data","defaultLocale","defaultLanguage","language","token","nativeName","formatMessage","fieldsets","item","title","fields","field","index","properties","required","indexOf"],"sources":["/home/jakob/workspace/training-project/node_modules/@plone/volto/src/components/manage/Multilingual/TranslationObject.jsx"],"sourcesContent":["/**\n * Add container.\n * @module components/manage/Add/Add\n */\n\nimport React, { useEffect, useState } from 'react';\nimport { map } from 'lodash';\nimport { defineMessages, useIntl } from 'react-intl';\nimport { Form as UiForm, Menu, Segment } from 'semantic-ui-react';\nimport { Provider } from 'react-intl-redux';\nimport { Form, Field } from '@plone/volto/components';\nimport config from '@plone/volto/registry';\nimport configureStore from '@plone/volto/store';\nimport {\n  Api,\n  flattenToAppURL,\n  langmap,\n  normalizeLanguageName,\n} from '@plone/volto/helpers';\nimport { createBrowserHistory } from 'history';\nconst messages = defineMessages({\n  document: {\n    id: 'Document',\n    defaultMessage: 'Document',\n  },\n});\n\n/**\n * TranslationObject class.\n * @class TranslationObject\n * @extends Component\n */\nconst TranslationObject = ({\n  translationObject,\n  schema,\n  pathname,\n  visual,\n  isFormSelected,\n  onSelectForm,\n}) => {\n  const intl = useIntl();\n\n  const [locales, setLocales] = useState({});\n  const [loadingLocale, setLoadingLocale] = useState(false);\n  const [activeMenu, setActiveMenu] = useState('language');\n  const handleMenuClick = (e, { name }) => {\n    setActiveMenu(name);\n  };\n\n  useEffect(() => {\n    if (\n      !loadingLocale &&\n      Object.keys(locales).length < config.settings.supportedLanguages.length\n    ) {\n      setLoadingLocale(true);\n      let lang =\n        config.settings.supportedLanguages[Object.keys(locales).length];\n      const langFileName = normalizeLanguageName(lang);\n      import('@root/../locales/' + langFileName + '.json').then((locale) => {\n        setLocales({ ...locales, [lang]: locale.default });\n        setLoadingLocale(false);\n      });\n    }\n  }, [loadingLocale, locales]);\n\n  const api = new Api();\n  const history = createBrowserHistory();\n  const store = configureStore(\n    {\n      ...window.__data,\n      intl: {\n        defaultLocale: config.settings.defaultLanguage,\n        locale: translationObject.language.token,\n        messages: locales[translationObject.language.token],\n      },\n    },\n    history,\n    api,\n  );\n\n  const lang = translationObject.language.token;\n\n  return translationObject && Object.keys(locales).length > 0 ? (\n    <Provider store={store}>\n      <>\n        <Menu pointing secondary attached tabular>\n          <Menu.Item\n            name=\"language\"\n            active={activeMenu === 'language'}\n            onClick={handleMenuClick}\n          >\n            {langmap[lang].nativeName}\n          </Menu.Item>\n          {visual && (\n            <Menu.Item\n              name=\"properties\"\n              active={activeMenu === 'properties'}\n              onClick={handleMenuClick}\n            >\n              {intl.formatMessage(messages.document)}\n            </Menu.Item>\n          )}\n        </Menu>\n        {activeMenu === 'language' && (\n          <Form\n            key=\"translation-object-form\"\n            schema={schema}\n            formData={translationObject}\n            type={translationObject['@type']}\n            onSubmit={() => {\n              /*do nothing*/\n            }}\n            hideActions\n            pathname={flattenToAppURL(translationObject['@id'])}\n            visual={visual}\n            title={langmap[lang].nativeName}\n            loading={false}\n            isFormSelected={isFormSelected}\n            onSelectForm={onSelectForm}\n            editable={false}\n            onChange={() => {}}\n          />\n        )}\n        {activeMenu === 'properties' && (\n          <UiForm method=\"post\" onSubmit={() => {}}>\n            <fieldset className=\"invisible\" disabled={true}>\n              {schema &&\n                map(schema.fieldsets, (item) => [\n                  <Segment secondary attached key={item.title}>\n                    {item.title}\n                  </Segment>,\n                  <Segment attached key={`fieldset-contents-${item.title}`}>\n                    {map(item.fields, (field, index) => (\n                      <Field\n                        {...schema.properties[field]}\n                        id={field}\n                        formData={translationObject}\n                        focus={false}\n                        value={translationObject[field]}\n                        required={schema.required.indexOf(field) !== -1}\n                        key={field}\n                        onChange={() => {}}\n                      />\n                    ))}\n                  </Segment>,\n                ])}\n            </fieldset>\n          </UiForm>\n        )}\n      </>\n    </Provider>\n  ) : null;\n};\n\nexport default TranslationObject;\n"],"mappings":"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"},"metadata":{"react-intl":{"messages":[{"id":"Document","defaultMessage":"Document"}]}},"sourceType":"module"}