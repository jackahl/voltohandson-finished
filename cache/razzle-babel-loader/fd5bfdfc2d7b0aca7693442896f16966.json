{"ast":null,"code":"import _sortBy from \"lodash/sortBy\";\nconst _excluded = [\"pluggable\", \"id\", \"dependencies\", \"children\"];\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n// ported to JS from MIT licensed https://github.com/robik/react-view-slot\n// We've renamed Slot => Pluggable, not to clash with Volto slots\nimport React from 'react';\nexport const context = /*#__PURE__*/React.createContext();\nexport function usePluggable(name) {\n  const ctx = React.useContext(context);\n\n  if (!ctx) {\n    throw new Error('Using <Pluggable> component or usePluggable hook outside of <PluggablesProvider>');\n  }\n\n  return ctx.pluggables[name] || [];\n}\n/**\n\n**/\n\nexport function Pluggable(props) {\n  const {\n    name,\n    maxCount,\n    reversed,\n    children,\n    params\n  } = props; // , ...rest\n\n  let pluggables = usePluggable(name);\n\n  if (maxCount !== undefined) {\n    pluggables = pluggables.slice(0, maxCount);\n  }\n\n  if (reversed !== undefined) {\n    pluggables = [...pluggables].reverse();\n  }\n\n  if (params && children) {\n    throw Error('Cannot specify render function and params props at the same time');\n  }\n\n  return React.useMemo(() => {\n    if (children) {\n      return children(pluggables);\n    }\n\n    return /*#__PURE__*/React.createElement(React.Fragment, {}, pluggables.map((R, i) => /*#__PURE__*/React.createElement(R, _objectSpread({\n      key: i.toString()\n    }, params))));\n  }, [params, pluggables, children]);\n}\nexport function usePlug({\n  pluggable,\n  id,\n  renderer,\n  dependencies,\n  options\n}) {\n  const pluggableContext = React.useContext(context);\n\n  if (!pluggableContext) {\n    throw new Error('Using <Plug> component or usePlug hook outside of <PluggablesProvider>');\n  }\n\n  const {\n    setPlug,\n    removePlug\n  } = pluggableContext;\n  const {\n    name,\n    order,\n    extra\n  } = options; // Could be that a Plug is empty (or it evaluates and have no children)\n\n  if (renderer) {\n    Object.assign(renderer, {\n      pluggableName: name,\n      extra,\n      order\n    });\n  }\n\n  React.useEffect(() => {\n    if (renderer) {\n      setPlug(pluggable, id, renderer);\n      return () => removePlug(pluggable, id);\n    }\n  }, dependencies // eslint-disable-line react-hooks/exhaustive-deps\n  );\n}\nexport const Plug = _ref => {\n  let {\n    pluggable,\n    id,\n    dependencies = [],\n    children\n  } = _ref,\n      options = _objectWithoutProperties(_ref, _excluded);\n\n  const renderer = children && (typeof children === 'function' ? children : () => children);\n  usePlug({\n    pluggable,\n    id,\n    renderer,\n    dependencies,\n    options\n  });\n  return null;\n};\nexport function createPluggable(name) {\n  const pluggable = props => /*#__PURE__*/React.createElement(Pluggable, _objectSpread({\n    name\n  }, props));\n\n  pluggable.pluggableName = name;\n  pluggable.Plug = createPlugComponent(name);\n  return pluggable;\n}\n\nfunction createPlugComponent(pluggableName) {\n  const plugComponent = props => /*#__PURE__*/React.createElement(Plug, _objectSpread({\n    pluggable: pluggableName\n  }, props));\n\n  plugComponent.displayName = `Pluggables(${pluggableName})`;\n  return plugComponent;\n}\n/**\n * Creates a Pluggable + Plug pair\n */\n\n\nexport function createPluggableAndPlug(name) {\n  const boundPluggable = createPluggable(name);\n  return [boundPluggable, boundPluggable.Plug];\n}\nexport const PluggablesProvider = ({\n  children\n}) => {\n  const setPlug = (pluggable, id, renderer) => {\n    Object.assign(renderer, {\n      id\n    });\n    setPluggables(prevState => _objectSpread(_objectSpread({}, prevState), {}, {\n      pluggables: _objectSpread(_objectSpread({}, prevState.pluggables), {}, {\n        [pluggable]: _sortBy([...(prevState.pluggables[pluggable] || []).filter(e => e.id !== id), renderer], e => e.order || 0)\n      })\n    }));\n  };\n\n  const removePlug = (pluggable, name) => {\n    setPluggables(prevState => _objectSpread(_objectSpread({}, prevState), {}, {\n      pluggables: _objectSpread(_objectSpread({}, prevState.pluggables), {}, {\n        [pluggable]: _sortBy((prevState.pluggables[pluggable] || []).filter(e => e.id !== name), e => e.order || 0)\n      })\n    }));\n  };\n\n  const initialPluggables = {\n    pluggables: {},\n    setPlug,\n    removePlug\n  };\n  const [pluggables, setPluggables] = React.useState(initialPluggables);\n  return /*#__PURE__*/React.createElement(context.Provider, {\n    value: pluggables\n  }, children);\n};\nexport default Pluggable;","map":{"version":3,"names":["React","context","createContext","usePluggable","name","ctx","useContext","Error","pluggables","Pluggable","props","maxCount","reversed","children","params","undefined","slice","reverse","useMemo","createElement","Fragment","map","R","i","key","toString","usePlug","pluggable","id","renderer","dependencies","options","pluggableContext","setPlug","removePlug","order","extra","Object","assign","pluggableName","useEffect","Plug","createPluggable","createPlugComponent","plugComponent","displayName","createPluggableAndPlug","boundPluggable","PluggablesProvider","setPluggables","prevState","filter","e","initialPluggables","useState","Provider","value"],"sources":["/home/jakob/workspace/training-project/node_modules/@plone/volto/src/components/manage/Pluggable/index.js"],"sourcesContent":["// ported to JS from MIT licensed https://github.com/robik/react-view-slot\n// We've renamed Slot => Pluggable, not to clash with Volto slots\n\nimport React from 'react';\nimport { sortBy } from 'lodash';\n\nexport const context = React.createContext();\n\nexport function usePluggable(name) {\n  const ctx = React.useContext(context);\n\n  if (!ctx) {\n    throw new Error(\n      'Using <Pluggable> component or usePluggable hook outside of <PluggablesProvider>',\n    );\n  }\n\n  return ctx.pluggables[name] || [];\n}\n\n/**\n\n**/\nexport function Pluggable(props) {\n  const { name, maxCount, reversed, children, params } = props; // , ...rest\n  let pluggables = usePluggable(name);\n\n  if (maxCount !== undefined) {\n    pluggables = pluggables.slice(0, maxCount);\n  }\n  if (reversed !== undefined) {\n    pluggables = [...pluggables].reverse();\n  }\n\n  if (params && children) {\n    throw Error(\n      'Cannot specify render function and params props at the same time',\n    );\n  }\n\n  return React.useMemo(() => {\n    if (children) {\n      return children(pluggables);\n    }\n\n    return React.createElement(\n      React.Fragment,\n      {},\n      pluggables.map((R, i) =>\n        React.createElement(R, { key: i.toString(), ...params }),\n      ),\n    );\n  }, [params, pluggables, children]);\n}\n\nexport function usePlug({ pluggable, id, renderer, dependencies, options }) {\n  const pluggableContext = React.useContext(context);\n  if (!pluggableContext) {\n    throw new Error(\n      'Using <Plug> component or usePlug hook outside of <PluggablesProvider>',\n    );\n  }\n  const { setPlug, removePlug } = pluggableContext;\n  const { name, order, extra } = options;\n\n  // Could be that a Plug is empty (or it evaluates and have no children)\n  if (renderer) {\n    Object.assign(renderer, { pluggableName: name, extra, order });\n  }\n\n  React.useEffect(\n    () => {\n      if (renderer) {\n        setPlug(pluggable, id, renderer);\n        return () => removePlug(pluggable, id);\n      }\n    },\n    dependencies, // eslint-disable-line react-hooks/exhaustive-deps\n  );\n}\n\nexport const Plug = ({\n  pluggable,\n  id,\n  dependencies = [],\n  children,\n  ...options\n}) => {\n  const renderer =\n    children && (typeof children === 'function' ? children : () => children);\n  usePlug({ pluggable, id, renderer, dependencies, options });\n  return null;\n};\n\nexport function createPluggable(name) {\n  const pluggable = (props) =>\n    React.createElement(Pluggable, { name, ...props });\n  pluggable.pluggableName = name;\n  pluggable.Plug = createPlugComponent(name);\n  return pluggable;\n}\n\nfunction createPlugComponent(pluggableName) {\n  const plugComponent = (props) =>\n    React.createElement(Plug, { pluggable: pluggableName, ...props });\n  plugComponent.displayName = `Pluggables(${pluggableName})`;\n  return plugComponent;\n}\n\n/**\n * Creates a Pluggable + Plug pair\n */\nexport function createPluggableAndPlug(name) {\n  const boundPluggable = createPluggable(name);\n  return [boundPluggable, boundPluggable.Plug];\n}\n\nexport const PluggablesProvider = ({ children }) => {\n  const setPlug = (pluggable, id, renderer) => {\n    Object.assign(renderer, { id });\n\n    setPluggables((prevState) => ({\n      ...prevState,\n      pluggables: {\n        ...prevState.pluggables,\n        [pluggable]: sortBy(\n          [\n            ...(prevState.pluggables[pluggable] || []).filter(\n              (e) => e.id !== id,\n            ),\n            renderer,\n          ],\n          (e) => e.order || 0,\n        ),\n      },\n    }));\n  };\n\n  const removePlug = (pluggable, name) => {\n    setPluggables((prevState) => ({\n      ...prevState,\n      pluggables: {\n        ...prevState.pluggables,\n        [pluggable]: sortBy(\n          (prevState.pluggables[pluggable] || []).filter((e) => e.id !== name),\n          (e) => e.order || 0,\n        ),\n      },\n    }));\n  };\n\n  const initialPluggables = {\n    pluggables: {},\n    setPlug,\n    removePlug,\n  };\n\n  const [pluggables, setPluggables] = React.useState(initialPluggables);\n  return React.createElement(context.Provider, { value: pluggables }, children);\n};\n\nexport default Pluggable;\n"],"mappings":"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"},"metadata":{"react-intl":{"messages":[]}},"sourceType":"module"}