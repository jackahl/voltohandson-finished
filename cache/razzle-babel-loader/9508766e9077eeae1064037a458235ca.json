{"ast":null,"code":"import _extends from \"/home/jakob/workspace/training-project/node_modules/@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"/home/jakob/workspace/training-project/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nconst _excluded = [\"href\", \"item\", \"openLinkInNewTab\", \"download\", \"children\", \"className\", \"title\"];\n\nvar _jsxFileName = \"/home/jakob/workspace/training-project/node_modules/@plone/volto/src/components/manage/UniversalLink/UniversalLink.jsx\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\n/*\n * UniversalLink\n * @module components/UniversalLink\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from 'react-router-dom';\nimport { useSelector } from 'react-redux';\nimport { flattenToAppURL, isInternalURL, URLUtils } from '@plone/volto/helpers/Url/Url';\nimport { matchPath } from 'react-router';\nimport config from '@plone/volto/registry';\n\nconst UniversalLink = _ref => {\n  _s();\n\n  var _find, _config$settings$exte;\n\n  let {\n    href,\n    item = null,\n    openLinkInNewTab,\n    download = false,\n    children,\n    className = null,\n    title = null\n  } = _ref,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  const token = useSelector(state => {\n    var _state$userSession;\n\n    return (_state$userSession = state.userSession) === null || _state$userSession === void 0 ? void 0 : _state$userSession.token;\n  });\n  let url = href;\n\n  if (!href && item) {\n    if (!item['@id']) {\n      // eslint-disable-next-line no-console\n      console.error('Invalid item passed to UniversalLink', item, props, children);\n      url = '#';\n    } else {\n      //case: generic item\n      url = flattenToAppURL(item['@id']); //case: item like a Link\n\n      let remoteUrl = item.remoteUrl || item.getRemoteUrl;\n\n      if (!token && remoteUrl) {\n        url = remoteUrl;\n      } //case: item of type 'File'\n\n\n      if (!token && config.settings.downloadableObjects.includes(item['@type'])) {\n        url = `${url}/@@download/file`;\n      }\n\n      if (!token && config.settings.viewableInBrowserObjects.includes(item['@type'])) {\n        url = `${url}/@@display-file/file`;\n      }\n    }\n  }\n\n  const isBlacklisted = ((_find = ((_config$settings$exte = config.settings.externalRoutes) !== null && _config$settings$exte !== void 0 ? _config$settings$exte : []).find(route => matchPath(flattenToAppURL(url), route.match))) === null || _find === void 0 ? void 0 : _find.length) > 0;\n  const isExternal = !isInternalURL(url) || isBlacklisted;\n  const isDownload = !isExternal && url.includes('@@download') || download;\n  const isDisplayFile = !isExternal && url.includes('@@display-file') || false;\n  const checkedURL = URLUtils.checkAndNormalizeUrl(url);\n  url = checkedURL.url;\n\n  let tag = __jsx(Link, _extends({\n    to: flattenToAppURL(url),\n    target: (openLinkInNewTab !== null && openLinkInNewTab !== void 0 ? openLinkInNewTab : false) ? '_blank' : null,\n    title: title,\n    className: className\n  }, props, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 5\n    }\n  }), children);\n\n  if (isExternal) {\n    tag = __jsx(\"a\", _extends({\n      href: url,\n      title: title,\n      target: !checkedURL.isMail && !checkedURL.isTelephone && !(openLinkInNewTab === false) ? '_blank' : null,\n      rel: \"noopener noreferrer\",\n      className: className\n    }, props, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 7\n      }\n    }), children);\n  } else if (isDownload) {\n    tag = __jsx(\"a\", _extends({\n      href: flattenToAppURL(url),\n      download: true,\n      title: title,\n      className: className\n    }, props, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 7\n      }\n    }), children);\n  } else if (isDisplayFile) {\n    tag = __jsx(\"a\", _extends({\n      href: flattenToAppURL(url),\n      title: title,\n      target: \"_blank\",\n      rel: \"noopener noreferrer\",\n      className: className\n    }, props, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 7\n      }\n    }), children);\n  }\n\n  return tag;\n};\n\n_s(UniversalLink, \"bD5+gKbiITcJRDYAIJK4ZSEgato=\", false, function () {\n  return [useSelector];\n});\n\n_c = UniversalLink;\nUniversalLink.propTypes = {\n  href: PropTypes.string,\n  openLinkInNewTab: PropTypes.bool,\n  download: PropTypes.bool,\n  className: PropTypes.string,\n  title: PropTypes.string,\n  item: PropTypes.shape({\n    '@id': PropTypes.string.isRequired,\n    remoteUrl: PropTypes.string //of plone @type 'Link'\n\n  }),\n  children: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.node), PropTypes.node])\n};\nexport default UniversalLink;\n\nvar _c;\n\n$RefreshReg$(_c, \"UniversalLink\");","map":{"version":3,"names":["React","PropTypes","Link","useSelector","flattenToAppURL","isInternalURL","URLUtils","matchPath","config","UniversalLink","href","item","openLinkInNewTab","download","children","className","title","props","token","state","userSession","url","console","error","remoteUrl","getRemoteUrl","settings","downloadableObjects","includes","viewableInBrowserObjects","isBlacklisted","externalRoutes","find","route","match","length","isExternal","isDownload","isDisplayFile","checkedURL","checkAndNormalizeUrl","tag","isMail","isTelephone","propTypes","string","bool","shape","isRequired","oneOfType","arrayOf","node"],"sources":["/home/jakob/workspace/training-project/node_modules/@plone/volto/src/components/manage/UniversalLink/UniversalLink.jsx"],"sourcesContent":["/*\n * UniversalLink\n * @module components/UniversalLink\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from 'react-router-dom';\nimport { useSelector } from 'react-redux';\nimport {\n  flattenToAppURL,\n  isInternalURL,\n  URLUtils,\n} from '@plone/volto/helpers/Url/Url';\nimport { matchPath } from 'react-router';\n\nimport config from '@plone/volto/registry';\n\nconst UniversalLink = ({\n  href,\n  item = null,\n  openLinkInNewTab,\n  download = false,\n  children,\n  className = null,\n  title = null,\n  ...props\n}) => {\n  const token = useSelector((state) => state.userSession?.token);\n\n  let url = href;\n  if (!href && item) {\n    if (!item['@id']) {\n      // eslint-disable-next-line no-console\n      console.error(\n        'Invalid item passed to UniversalLink',\n        item,\n        props,\n        children,\n      );\n      url = '#';\n    } else {\n      //case: generic item\n      url = flattenToAppURL(item['@id']);\n\n      //case: item like a Link\n      let remoteUrl = item.remoteUrl || item.getRemoteUrl;\n      if (!token && remoteUrl) {\n        url = remoteUrl;\n      }\n\n      //case: item of type 'File'\n      if (\n        !token &&\n        config.settings.downloadableObjects.includes(item['@type'])\n      ) {\n        url = `${url}/@@download/file`;\n      }\n\n      if (\n        !token &&\n        config.settings.viewableInBrowserObjects.includes(item['@type'])\n      ) {\n        url = `${url}/@@display-file/file`;\n      }\n    }\n  }\n\n  const isBlacklisted =\n    (config.settings.externalRoutes ?? []).find((route) =>\n      matchPath(flattenToAppURL(url), route.match),\n    )?.length > 0;\n  const isExternal = !isInternalURL(url) || isBlacklisted;\n  const isDownload = (!isExternal && url.includes('@@download')) || download;\n  const isDisplayFile =\n    (!isExternal && url.includes('@@display-file')) || false;\n\n  const checkedURL = URLUtils.checkAndNormalizeUrl(url);\n\n  url = checkedURL.url;\n\n  let tag = (\n    <Link\n      to={flattenToAppURL(url)}\n      target={openLinkInNewTab ?? false ? '_blank' : null}\n      title={title}\n      className={className}\n      {...props}\n    >\n      {children}\n    </Link>\n  );\n\n  if (isExternal) {\n    tag = (\n      <a\n        href={url}\n        title={title}\n        target={\n          !checkedURL.isMail &&\n          !checkedURL.isTelephone &&\n          !(openLinkInNewTab === false)\n            ? '_blank'\n            : null\n        }\n        rel=\"noopener noreferrer\"\n        className={className}\n        {...props}\n      >\n        {children}\n      </a>\n    );\n  } else if (isDownload) {\n    tag = (\n      <a\n        href={flattenToAppURL(url)}\n        download\n        title={title}\n        className={className}\n        {...props}\n      >\n        {children}\n      </a>\n    );\n  } else if (isDisplayFile) {\n    tag = (\n      <a\n        href={flattenToAppURL(url)}\n        title={title}\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n        className={className}\n        {...props}\n      >\n        {children}\n      </a>\n    );\n  }\n  return tag;\n};\n\nUniversalLink.propTypes = {\n  href: PropTypes.string,\n  openLinkInNewTab: PropTypes.bool,\n  download: PropTypes.bool,\n  className: PropTypes.string,\n  title: PropTypes.string,\n  item: PropTypes.shape({\n    '@id': PropTypes.string.isRequired,\n    remoteUrl: PropTypes.string, //of plone @type 'Link'\n  }),\n  children: PropTypes.oneOfType([\n    PropTypes.arrayOf(PropTypes.node),\n    PropTypes.node,\n  ]),\n};\n\nexport default UniversalLink;\n"],"mappings":"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"},"metadata":{"react-intl":{"messages":[]}},"sourceType":"module"}