{"ast":null,"code":"import _isFunction from \"lodash/isFunction\";\nimport _isEqual from \"lodash/isEqual\";\nvar _jsxFileName = \"/home/jakob/workspace/training-project/node_modules/@plone/volto/src/components/manage/Blocks/Search/SearchBlockView.jsx\";\nvar __jsx = React.createElement;\n\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React from 'react';\nimport ListingBody from '@plone/volto/components/manage/Blocks/Listing/ListingBody';\nimport { withBlockExtensions } from '@plone/volto/helpers';\nimport config from '@plone/volto/registry';\nimport { withSearch, withQueryString } from './hocs';\nimport { compose } from 'redux';\nimport { useSelector } from 'react-redux';\n\nconst getListingBodyVariation = data => {\n  const {\n    variations\n  } = config.blocks.blocksConfig.listing;\n  const variation = data.listingBodyTemplate ? variations.find(({\n    id\n  }) => id === data.listingBodyTemplate) : variations.find(({\n    isDefault\n  }) => isDefault);\n  return variation;\n};\n\nconst isfunc = obj => _isFunction(obj) || typeof obj === 'function';\n\nconst _filtered = obj => Object.assign({}, ...Object.keys(obj).map(k => {\n  const reject = k !== 'properties' && !isfunc(obj[k]);\n  return reject ? {\n    [k]: obj[k]\n  } : {};\n}));\n\nconst blockPropsAreChanged = (prevProps, nextProps) => {\n  const prev = _filtered(prevProps);\n\n  const next = _filtered(nextProps);\n\n  return _isEqual(prev, next);\n};\n\nconst applyDefaults = (data, root) => {\n  var _data$query;\n\n  const defaultQuery = [{\n    i: 'path',\n    o: 'plone.app.querystring.operation.string.absolutePath',\n    v: root || '/'\n  }];\n  return _objectSpread(_objectSpread({}, data), {}, {\n    sort_on: (data === null || data === void 0 ? void 0 : data.sort_on) || 'effective',\n    sort_order: (data === null || data === void 0 ? void 0 : data.sort_order) || 'descending',\n    query: data !== null && data !== void 0 && (_data$query = data.query) !== null && _data$query !== void 0 && _data$query.length ? data.query : defaultQuery\n  });\n};\n\nconst SearchBlockView = props => {\n  const {\n    data,\n    searchData,\n    mode = 'view',\n    variation\n  } = props;\n  const Layout = variation.view;\n  const listingBodyVariation = getListingBodyVariation(data);\n  const root = useSelector(state => state.breadcrumbs.root);\n  const listingBodyData = applyDefaults(searchData, root);\n  return __jsx(\"div\", {\n    className: \"block search\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 5\n    }\n  }, __jsx(Layout, _extends({}, props, {\n    isEditMode: mode === 'edit',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }\n  }), __jsx(ListingBody, {\n    variation: _objectSpread(_objectSpread({}, data), listingBodyVariation),\n    data: listingBodyData,\n    path: props.path,\n    isEditMode: mode === 'edit',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 9\n    }\n  })));\n};\n\nexport const SearchBlockViewComponent = compose(withBlockExtensions, Component => /*#__PURE__*/React.memo(Component, blockPropsAreChanged))(SearchBlockView);\nexport default compose(withQueryString, withSearch())(SearchBlockViewComponent);","map":{"version":3,"names":["React","ListingBody","withBlockExtensions","config","withSearch","withQueryString","compose","useSelector","getListingBodyVariation","data","variations","blocks","blocksConfig","listing","variation","listingBodyTemplate","find","id","isDefault","isfunc","obj","_filtered","Object","assign","keys","map","k","reject","blockPropsAreChanged","prevProps","nextProps","prev","next","applyDefaults","root","defaultQuery","i","o","v","sort_on","sort_order","query","length","SearchBlockView","props","searchData","mode","Layout","view","listingBodyVariation","state","breadcrumbs","listingBodyData","path","SearchBlockViewComponent","Component","memo"],"sources":["/home/jakob/workspace/training-project/node_modules/@plone/volto/src/components/manage/Blocks/Search/SearchBlockView.jsx"],"sourcesContent":["import React from 'react';\n\nimport ListingBody from '@plone/volto/components/manage/Blocks/Listing/ListingBody';\nimport { withBlockExtensions } from '@plone/volto/helpers';\n\nimport config from '@plone/volto/registry';\n\nimport { withSearch, withQueryString } from './hocs';\nimport { compose } from 'redux';\nimport { useSelector } from 'react-redux';\nimport { isEqual, isFunction } from 'lodash';\n\nconst getListingBodyVariation = (data) => {\n  const { variations } = config.blocks.blocksConfig.listing;\n\n  const variation = data.listingBodyTemplate\n    ? variations.find(({ id }) => id === data.listingBodyTemplate)\n    : variations.find(({ isDefault }) => isDefault);\n\n  return variation;\n};\n\nconst isfunc = (obj) => isFunction(obj) || typeof obj === 'function';\n\nconst _filtered = (obj) =>\n  Object.assign(\n    {},\n    ...Object.keys(obj).map((k) => {\n      const reject = k !== 'properties' && !isfunc(obj[k]);\n      return reject ? { [k]: obj[k] } : {};\n    }),\n  );\n\nconst blockPropsAreChanged = (prevProps, nextProps) => {\n  const prev = _filtered(prevProps);\n  const next = _filtered(nextProps);\n\n  return isEqual(prev, next);\n};\n\nconst applyDefaults = (data, root) => {\n  const defaultQuery = [\n    {\n      i: 'path',\n      o: 'plone.app.querystring.operation.string.absolutePath',\n      v: root || '/',\n    },\n  ];\n  return {\n    ...data,\n    sort_on: data?.sort_on || 'effective',\n    sort_order: data?.sort_order || 'descending',\n    query: data?.query?.length ? data.query : defaultQuery,\n  };\n};\n\nconst SearchBlockView = (props) => {\n  const { data, searchData, mode = 'view', variation } = props;\n\n  const Layout = variation.view;\n\n  const listingBodyVariation = getListingBodyVariation(data);\n  const root = useSelector((state) => state.breadcrumbs.root);\n  const listingBodyData = applyDefaults(searchData, root);\n\n  return (\n    <div className=\"block search\">\n      <Layout {...props} isEditMode={mode === 'edit'}>\n        <ListingBody\n          variation={{ ...data, ...listingBodyVariation }}\n          data={listingBodyData}\n          path={props.path}\n          isEditMode={mode === 'edit'}\n        />\n      </Layout>\n    </div>\n  );\n};\n\nexport const SearchBlockViewComponent = compose(\n  withBlockExtensions,\n  (Component) => React.memo(Component, blockPropsAreChanged),\n)(SearchBlockView);\n\nexport default compose(withQueryString, withSearch())(SearchBlockViewComponent);\n"],"mappings":"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"},"metadata":{"react-intl":{"messages":[]}},"sourceType":"module"}