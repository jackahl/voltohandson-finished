{"ast":null,"code":"import { Node } from 'slate';\nimport { isCursorAtBlockStart, isCursorAtBlockEnd, getNextVoltoBlock, getPreviousVoltoBlock, createDefaultBlock } from '@plone/volto-slate/utils';\n/**\n * goUp.\n *\n * @param {}\n */\n\nexport function goUp(_ref) {\n  let {\n    editor,\n    event\n  } = _ref;\n\n  if (isCursorAtBlockStart(editor)) {\n    var _prev$;\n\n    const props = editor.getBlockProps();\n    const {\n      onFocusPreviousBlock,\n      block,\n      blockNode\n    } = props; // const { formContext } = editor;\n    // const properties = formContext.contextData.formData;\n\n    const {\n      properties\n    } = editor.getBlockProps();\n    const prev = getPreviousVoltoBlock(props.index, properties);\n    if (!prev || ((_prev$ = prev[0]) === null || _prev$ === void 0 ? void 0 : _prev$['@type']) !== 'slate') return onFocusPreviousBlock(block, blockNode.current);\n    const [slateBlock, id] = prev;\n    const pseudoEditor = {\n      children: slateBlock.value || [createDefaultBlock()]\n    };\n    const match = Node.last(pseudoEditor, []);\n    if (!match) return onFocusPreviousBlock(block, blockNode.current);\n    const [node, path] = match;\n    const point = {\n      path,\n      offset: ((node === null || node === void 0 ? void 0 : node.text) || '').length\n    };\n    const selection = {\n      anchor: point,\n      focus: point\n    };\n    props.saveSlateBlockSelection(id, selection);\n    return onFocusPreviousBlock(block, blockNode.current);\n  }\n}\n/**\n * goDown.\n *\n * @param {}\n */\n\nexport function goDown(_ref2) {\n  let {\n    editor,\n    event\n  } = _ref2;\n\n  if (isCursorAtBlockEnd(editor)) {\n    var _next$;\n\n    const props = editor.getBlockProps();\n    const {\n      onFocusNextBlock,\n      block,\n      blockNode\n    } = props; // const { formContext } = editor;\n    // const properties = formContext.contextData.formData;\n\n    const {\n      properties\n    } = editor.getBlockProps();\n    const next = getNextVoltoBlock(props.index, properties);\n    if (!next || ((_next$ = next[0]) === null || _next$ === void 0 ? void 0 : _next$['@type']) !== 'slate') return onFocusNextBlock(block, blockNode.current);\n    const [slateBlock, id] = next;\n    const pseudoEditor = {\n      children: slateBlock.value || [createDefaultBlock()]\n    };\n    const match = Node.first(pseudoEditor, []);\n    if (!match) return onFocusNextBlock(block, blockNode.current);\n    const path = match[1];\n    const point = {\n      path,\n      offset: 0\n    };\n    const selection = {\n      anchor: point,\n      focus: point\n    };\n    props.saveSlateBlockSelection(id, selection);\n    return onFocusNextBlock(block, blockNode.current);\n  }\n}\nexport function traverseBlocks(opts) {\n  const {\n    event\n  } = opts;\n  event.preventDefault(); // return event.shiftKey ? goUp(opts) : goDown(opts);\n\n  return true;\n}","map":{"version":3,"names":["Node","isCursorAtBlockStart","isCursorAtBlockEnd","getNextVoltoBlock","getPreviousVoltoBlock","createDefaultBlock","goUp","editor","event","props","getBlockProps","onFocusPreviousBlock","block","blockNode","properties","prev","index","current","slateBlock","id","pseudoEditor","children","value","match","last","node","path","point","offset","text","length","selection","anchor","focus","saveSlateBlockSelection","goDown","onFocusNextBlock","next","first","traverseBlocks","opts","preventDefault"],"sources":["/home/jakob/workspace/training-project/node_modules/@plone/volto/packages/volto-slate/src/blocks/Text/keyboard/traverseBlocks.js"],"sourcesContent":["import { Node } from 'slate';\nimport {\n  isCursorAtBlockStart,\n  isCursorAtBlockEnd,\n  getNextVoltoBlock,\n  getPreviousVoltoBlock,\n  createDefaultBlock,\n} from '@plone/volto-slate/utils';\n\n/**\n * goUp.\n *\n * @param {}\n */\nexport function goUp({ editor, event }) {\n  if (isCursorAtBlockStart(editor)) {\n    const props = editor.getBlockProps();\n    const { onFocusPreviousBlock, block, blockNode } = props;\n\n    // const { formContext } = editor;\n    // const properties = formContext.contextData.formData;\n    const { properties } = editor.getBlockProps();\n\n    const prev = getPreviousVoltoBlock(props.index, properties);\n    if (!prev || prev[0]?.['@type'] !== 'slate')\n      return onFocusPreviousBlock(block, blockNode.current);\n\n    const [slateBlock, id] = prev;\n    const pseudoEditor = {\n      children: slateBlock.value || [createDefaultBlock()],\n    };\n    const match = Node.last(pseudoEditor, []);\n    if (!match) return onFocusPreviousBlock(block, blockNode.current);\n\n    const [node, path] = match;\n    const point = { path, offset: (node?.text || '').length };\n    const selection = { anchor: point, focus: point };\n    props.saveSlateBlockSelection(id, selection);\n    return onFocusPreviousBlock(block, blockNode.current);\n  }\n}\n\n/**\n * goDown.\n *\n * @param {}\n */\nexport function goDown({ editor, event }) {\n  if (isCursorAtBlockEnd(editor)) {\n    const props = editor.getBlockProps();\n    const { onFocusNextBlock, block, blockNode } = props;\n\n    // const { formContext } = editor;\n    // const properties = formContext.contextData.formData;\n    const { properties } = editor.getBlockProps();\n\n    const next = getNextVoltoBlock(props.index, properties);\n    if (!next || next[0]?.['@type'] !== 'slate')\n      return onFocusNextBlock(block, blockNode.current);\n\n    const [slateBlock, id] = next;\n    const pseudoEditor = {\n      children: slateBlock.value || [createDefaultBlock()],\n    };\n    const match = Node.first(pseudoEditor, []);\n    if (!match) return onFocusNextBlock(block, blockNode.current);\n\n    const path = match[1];\n    const point = { path, offset: 0 };\n    const selection = { anchor: point, focus: point };\n    props.saveSlateBlockSelection(id, selection);\n    return onFocusNextBlock(block, blockNode.current);\n  }\n}\n\nexport function traverseBlocks(opts) {\n  const { event } = opts;\n  event.preventDefault();\n  // return event.shiftKey ? goUp(opts) : goDown(opts);\n  return true;\n}\n"],"mappings":"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"},"metadata":{"react-intl":{"messages":[]}},"sourceType":"module"}